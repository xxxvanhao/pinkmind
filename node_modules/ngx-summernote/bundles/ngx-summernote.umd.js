(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/common/http'), require('@angular/core'), require('@angular/forms'), require('rxjs'), require('rxjs/operators')) :
    typeof define === 'function' && define.amd ? define('ngx-summernote', ['exports', '@angular/common/http', '@angular/core', '@angular/forms', 'rxjs', 'rxjs/operators'], factory) :
    (factory((global['ngx-summernote'] = {}),global.ng.common.http,global.ng.core,global.ng.forms,global.rxjs,global.rxjs.operators));
}(this, (function (exports,http,core,forms,rxjs,operators) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function (resolve, reject) {
            function fulfilled(value) { try {
                step(generator.next(value));
            }
            catch (e) {
                reject(e);
            } }
            function rejected(value) { try {
                step(generator["throw"](value));
            }
            catch (e) {
                reject(e);
            } }
            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = { label: 0, sent: function () { if (t[0] & 1)
                throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
        return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function () { return this; }), g;
        function verb(n) { return function (v) { return step([n, v]); }; }
        function step(op) {
            if (f)
                throw new TypeError("Generator is already executing.");
            while (_)
                try {
                    if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)
                        return t;
                    if (y = 0, t)
                        op = [op[0] & 2, t.value];
                    switch (op[0]) {
                        case 0:
                        case 1:
                            t = op;
                            break;
                        case 4:
                            _.label++;
                            return { value: op[1], done: false };
                        case 5:
                            _.label++;
                            y = op[1];
                            op = [0];
                            continue;
                        case 7:
                            op = _.ops.pop();
                            _.trys.pop();
                            continue;
                        default:
                            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                                _ = 0;
                                continue;
                            }
                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {
                                _.label = op[1];
                                break;
                            }
                            if (op[0] === 6 && _.label < t[1]) {
                                _.label = t[1];
                                t = op;
                                break;
                            }
                            if (t && _.label < t[2]) {
                                _.label = t[2];
                                _.ops.push(op);
                                break;
                            }
                            if (t[2])
                                _.ops.pop();
                            _.trys.pop();
                            continue;
                    }
                    op = body.call(thisArg, _);
                }
                catch (e) {
                    op = [6, e];
                    y = 0;
                }
                finally {
                    f = t = 0;
                }
            if (op[0] & 5)
                throw op[1];
            return { value: op[0] ? op[1] : void 0, done: true };
        }
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var NgxSummernoteDirective = /** @class */ (function () {
        function NgxSummernoteDirective(el, zone, http$$1) {
            var _this = this;
            this.zone = zone;
            this.http = http$$1;
            // summernoteModel directive as output: update model if editor contentChanged
            this.summernoteModelChange = new core.EventEmitter();
            this.imageUpload = new core.EventEmitter();
            // summernoteInit directive as output: send manual editor initialization
            this.summernoteInit = new core.EventEmitter();
            this.blur = new core.EventEmitter();
            this._options = {
                immediateAngularModelUpdate: false,
                angularIgnoreAttrs: null,
                placeholder: '',
                tabsize: 2,
                height: 100,
                uploadImagePath: '',
                toolbar: [
                    // [groupName, [list of button]]
                    ['misc', ['codeview', 'undo', 'redo', 'codeBlock']],
                    // ['style', ['bold', 'italic', 'underline', 'clear']],
                    ['font', ['bold', 'italic', 'underline', 'strikethrough', 'superscript', 'subscript', 'clear']],
                    ['fontsize', ['fontname', 'fontsize', 'color']],
                    ['para', ['style0', 'ul', 'ol', 'paragraph', 'height']],
                    ['insert', ['table', 'picture', 'link', 'video', 'hr']],
                ],
                fontNames: ['Helvetica', 'Arial', 'Arial Black', 'Comic Sans MS', 'Courier New', 'Roboto', 'Times'],
                callbacks: {
                    onImageUpload: function (files) { return _this.uploadImage(files); }
                },
                buttons: {
                    codeBlock: this.codeBlockButton()
                }
            };
            this.SPECIAL_TAGS = ['img', 'button', 'input', 'a'];
            this.INNER_HTML_ATTR = 'innerHTML';
            this._oldModel = null;
            // Begin ControlValueAccesor methods.
            this.onChange = function (_) { };
            this.onTouched = function () { };
            /** @type {?} */
            var element = el.nativeElement;
            // check if the element is a special tag
            if (this.SPECIAL_TAGS.indexOf(element.tagName.toLowerCase()) !== -1) {
                this._hasSpecialTag = true;
            }
            // jquery wrap and store element
            this._$element = (( /** @type {?} */($(element))));
            this.zone = zone;
        }
        Object.defineProperty(NgxSummernoteDirective.prototype, "ngxSummernote", {
            set: /**
             * @param {?} options
             * @return {?}
             */ function (options) {
                if (options.buttons) {
                    Object.assign(options.buttons, this._options.buttons);
                }
                this._options = Object.assign(this._options, options);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(NgxSummernoteDirective.prototype, "summernoteModel", {
            // summernoteModel directive as input: store initial editor content
            set: 
            // summernoteModel directive as input: store initial editor content
            /**
             * @param {?} content
             * @return {?}
             */
            function (content) {
                this.updateEditor(content);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        NgxSummernoteDirective.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                this._options.toolbar;
                // check if output summernoteInit is present. Maybe observers is private and
                // should not be used?? TODO how to better test that an output directive is present.
                if (!this.summernoteInit.observers.length) {
                    this.createEditor();
                }
                else {
                    // TODO not sure it works now...
                    this.generateManualController();
                }
            };
        /**
         * @param {?} changes
         * @return {?}
         */
        NgxSummernoteDirective.prototype.ngOnChanges = /**
         * @param {?} changes
         * @return {?}
         */
            function (changes) {
                if (this._editorInitialized && changes) {
                    if (changes.ngxSummernoteDisabled && !changes.ngxSummernoteDisabled.firstChange &&
                        changes.ngxSummernoteDisabled.currentValue !== changes.ngxSummernoteDisabled.previousValue) {
                        if (changes.ngxSummernoteDisabled.currentValue) {
                            this._$element.summernote('disable');
                        }
                        else {
                            this._$element.summernote('enable');
                        }
                    }
                }
            };
        /**
         * @return {?}
         */
        NgxSummernoteDirective.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.destroyEditor();
            };
        // Form model content changed.
        // Form model content changed.
        /**
         * @param {?} content
         * @return {?}
         */
        NgxSummernoteDirective.prototype.writeValue =
            // Form model content changed.
            /**
             * @param {?} content
             * @return {?}
             */
            function (content) {
                this.updateEditor(content);
            };
        /**
         * @param {?} fn
         * @return {?}
         */
        NgxSummernoteDirective.prototype.registerOnChange = /**
         * @param {?} fn
         * @return {?}
         */
            function (fn) { this.onChange = fn; };
        /**
         * @param {?} fn
         * @return {?}
         */
        NgxSummernoteDirective.prototype.registerOnTouched = /**
         * @param {?} fn
         * @return {?}
         */
            function (fn) { this.onTouched = fn; };
        // Update editor with model contents.
        // Update editor with model contents.
        /**
         * @private
         * @param {?} content
         * @return {?}
         */
        NgxSummernoteDirective.prototype.updateEditor =
            // Update editor with model contents.
            /**
             * @private
             * @param {?} content
             * @return {?}
             */
            function (content) {
                if (JSON.stringify(this._oldModel) === JSON.stringify(content)) {
                    return;
                }
                this._oldModel = content;
                this._$element.html(content);
                if (this._editorInitialized) {
                    this._$element.summernote('code', content);
                }
                else {
                    this._$element.html(content);
                }
            };
        // update model if editor contentChanged
        // update model if editor contentChanged
        /**
         * @private
         * @param {?=} content
         * @return {?}
         */
        NgxSummernoteDirective.prototype.updateModel =
            // update model if editor contentChanged
            /**
             * @private
             * @param {?=} content
             * @return {?}
             */
            function (content) {
                var _this = this;
                // console.log("update model", content)
                this.zone.run(function () {
                    /** @type {?} */
                    var modelContent = null;
                    if (_this._hasSpecialTag) {
                        /** @type {?} */
                        var attributeNodes = _this._$element[0].attributes;
                        /** @type {?} */
                        var attrs = {};
                        for (var i = 0; i < attributeNodes.length; i++) {
                            /** @type {?} */
                            var attrName = attributeNodes[i].name;
                            if (_this._options.angularIgnoreAttrs && _this._options.angularIgnoreAttrs.indexOf(attrName) !== -1) {
                                continue;
                            }
                            attrs[attrName] = attributeNodes[i].value;
                        }
                        if (_this._$element[0].innerHTML) {
                            attrs[_this.INNER_HTML_ATTR] = _this._$element[0].innerHTML;
                        }
                        modelContent = attrs;
                    }
                    else {
                        /** @type {?} */
                        var returnedHtml = content || '';
                        if (typeof returnedHtml === 'string') {
                            modelContent = returnedHtml;
                        }
                    }
                    _this._oldModel = modelContent;
                    // Update summernoteModel
                    _this.summernoteModelChange.emit(modelContent);
                    // Update form model.
                    _this.onChange(content);
                });
            };
        /**
         * @private
         * @return {?}
         */
        NgxSummernoteDirective.prototype.initListeners = /**
         * @private
         * @return {?}
         */
            function () {
                /** @type {?} */
                var self = this;
                if (!this._$element) {
                    return;
                }
                this._$element.on('summernote.init', function () {
                    setTimeout(function () {
                        self.updateModel();
                    }, 0);
                });
                this._$element.on('summernote.change', function (event, contents, $editable) {
                    setTimeout(function () {
                        self.updateModel(contents);
                    }, 0);
                });
                this._$element.on('summernote.blur', function () {
                    setTimeout(function () {
                        self.onTouched();
                        self.blur.emit();
                    }, 0);
                });
                if (this._options.immediateAngularModelUpdate) {
                    this._editor.on('keyup', function () {
                        setTimeout(function () {
                            self.updateModel();
                        }, 0);
                    });
                }
            };
        /**
         * @private
         * @return {?}
         */
        NgxSummernoteDirective.prototype.createEditor = /**
         * @private
         * @return {?}
         */
            function () {
                var _this = this;
                if (this._editorInitialized) {
                    return;
                }
                this.setContent(true);
                // this.initListeners(); // issue #31 
                // init editor
                this.zone.runOutsideAngular(function () {
                    _this._editor = _this._$element.summernote(_this._options).data('summernote').$note;
                    _this.initListeners(); // issue #31
                    if (_this.ngxSummernoteDisabled) {
                        _this._$element.summernote('disable');
                    }
                });
                this._editorInitialized = true;
            };
        /**
         * @private
         * @return {?}
         */
        NgxSummernoteDirective.prototype.setHtml = /**
         * @private
         * @return {?}
         */
            function () {
                this._$element.summernote('code', this._model || '', true);
            };
        /**
         * @private
         * @param {?=} firstTime
         * @return {?}
         */
        NgxSummernoteDirective.prototype.setContent = /**
         * @private
         * @param {?=} firstTime
         * @return {?}
         */
            function (firstTime) {
                if (firstTime === void 0) {
                    firstTime = false;
                }
                // console.log("set content", firstTime, this._oldModel, this._model)
                /** @type {?} */
                var self = this;
                // Set initial content
                if (this._model || this._model === '') {
                    this._oldModel = this._model;
                    if (this._hasSpecialTag) {
                        /** @type {?} */
                        var tags = this._model;
                        // add tags on element
                        if (tags) {
                            for (var attr in tags) {
                                if (tags.hasOwnProperty(attr) && attr !== this.INNER_HTML_ATTR) {
                                    this._$element.attr(attr, tags[attr]);
                                }
                            }
                            if (tags.hasOwnProperty(this.INNER_HTML_ATTR)) {
                                this._$element[0].innerHTML = tags[this.INNER_HTML_ATTR];
                            }
                        }
                    }
                    else {
                        self.setHtml();
                    }
                }
            };
        /**
         * @private
         * @return {?}
         */
        NgxSummernoteDirective.prototype.destroyEditor = /**
         * @private
         * @return {?}
         */
            function () {
                if (this._editorInitialized) {
                    this._editor.off('keyup');
                    this._$element.summernote('destroy'); // TODO not sure it works now...
                    this._editorInitialized = false;
                }
            };
        /**
         * @private
         * @return {?}
         */
        NgxSummernoteDirective.prototype.getEditor = /**
         * @private
         * @return {?}
         */
            function () {
                if (this._$element) {
                    return this._$element.summernote.bind(this._$element);
                }
                return null;
            };
        // send manual editor initialization
        // TODO not sure it works now...
        // send manual editor initialization
        // TODO not sure it works now...
        /**
         * @private
         * @return {?}
         */
        NgxSummernoteDirective.prototype.generateManualController =
            // send manual editor initialization
            // TODO not sure it works now...
            /**
             * @private
             * @return {?}
             */
            function () {
                /** @type {?} */
                var controls = {
                    initialize: this.createEditor.bind(this),
                    destroy: this.destroyEditor.bind(this),
                    getEditor: this.getEditor.bind(this),
                };
                this.summernoteInit.emit(controls);
            };
        /**
         * @private
         * @param {?} files
         * @return {?}
         */
        NgxSummernoteDirective.prototype.uploadImage = /**
         * @private
         * @param {?} files
         * @return {?}
         */
            function (files) {
                return __awaiter(this, void 0, void 0, function () {
                    var data;
                    var _this = this;
                    return __generator(this, function (_a) {
                        data = new FormData();
                        this.imageUpload.emit({ uploading: true });
                        data.append('image', files[0]);
                        if (this._options.uploadImagePath) {
                            this.http.post(this._options.uploadImagePath, data)
                                .pipe(operators.map(function (response) { return response && typeof response.path === 'string' && response.path; }), operators.catchError(function (e) {
                                rxjs.throwError('An error occured while uploading' + e);
                                return rxjs.of('');
                            }))
                                .subscribe(function (dataIn) {
                                if (dataIn) {
                                    _this._$element.summernote('insertImage', dataIn);
                                    _this.imageUpload.emit({ uploading: false });
                                }
                                else {
                                    _this.insertFromDataURL(files);
                                }
                            }, function (e) {
                                _this.insertFromDataURL(files);
                            });
                        }
                        else {
                            this.insertFromDataURL(files);
                        }
                        return [2 /*return*/];
                    });
                });
            };
        /**
         * @param {?} files
         * @return {?}
         */
        NgxSummernoteDirective.prototype.insertFromDataURL = /**
         * @param {?} files
         * @return {?}
         */
            function (files) {
                var _this = this;
                /** @type {?} */
                var reader = new FileReader();
                reader.readAsDataURL(files[0]);
                reader.onload = function () {
                    _this._$element.summernote('insertImage', reader.result);
                    _this.imageUpload.emit({ uploading: false, encoding: 'base64' });
                };
                reader.onerror = function (error) { return console.error(error); };
            };
        /**
         * @private
         * @return {?}
         */
        NgxSummernoteDirective.prototype.codeBlockButton = /**
         * @private
         * @return {?}
         */
            function () {
                return function (context) {
                    /** @type {?} */
                    var ui = $.summernote.ui;
                    // create button
                    /** @type {?} */
                    var button = ui.button({
                        contents: 'Code block',
                        tooltip: 'Add raw code',
                        click: function () {
                            /** @type {?} */
                            var selectedText = null;
                            // The below code will copy the selected block and add it into our code=block
                            if (window.getSelection) {
                                selectedText = window.getSelection().toString().replace(/^\s+|\s+$/g, '');
                            }
                            /** @type {?} */
                            var codeText = selectedText ? selectedText : "Place your code here.";
                            /** @type {?} */
                            var codeBlock = "<pre class=\"code-block\" style=\"font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; padding: 14px 12px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(250, 251, 253); border: 1px solid rgb(234, 236, 240); border-radius: 4px; color: #60a0b0\"><span style=\"white-space: pre-wrap;\">" + codeText + "</span></pre>";
                            context.invoke('editor.pasteHTML', codeBlock);
                        }
                    });
                    return button.render(); // return button as jquery object
                };
            };
        NgxSummernoteDirective.decorators = [
            { type: core.Directive, args: [{
                        // tslint:disable-next-line:directive-selector
                        selector: '[ngxSummernote]',
                        providers: [{
                                provide: forms.NG_VALUE_ACCESSOR,
                                useExisting: core.forwardRef(function () { return NgxSummernoteDirective; }),
                                multi: true
                            }]
                    },] },
        ];
        /** @nocollapse */
        NgxSummernoteDirective.ctorParameters = function () {
            return [
                { type: core.ElementRef },
                { type: core.NgZone },
                { type: http.HttpClient }
            ];
        };
        NgxSummernoteDirective.propDecorators = {
            ngxSummernote: [{ type: core.Input }],
            summernoteModel: [{ type: core.Input }],
            summernoteModelChange: [{ type: core.Output }],
            imageUpload: [{ type: core.Output }],
            summernoteInit: [{ type: core.Output }],
            blur: [{ type: core.Output }],
            ngxSummernoteDisabled: [{ type: core.Input }]
        };
        return NgxSummernoteDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var NgxSummernoteViewDirective = /** @class */ (function () {
        function NgxSummernoteViewDirective(renderer, element) {
            this.renderer = renderer;
            this._element = element.nativeElement;
        }
        Object.defineProperty(NgxSummernoteViewDirective.prototype, "ngxSummernoteView", {
            set: /**
             * @param {?} content
             * @return {?}
             */ function (content) {
                this._element.innerHTML = content || '';
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        NgxSummernoteViewDirective.prototype.ngAfterViewInit = /**
         * @return {?}
         */
            function () {
                this.renderer.setElementClass(this._element, 'ngx-summernote-view', true);
            };
        NgxSummernoteViewDirective.decorators = [
            { type: core.Directive, args: [{
                        // tslint:disable-next-line:directive-selector
                        selector: '[ngxSummernoteView]'
                    },] },
        ];
        /** @nocollapse */
        NgxSummernoteViewDirective.ctorParameters = function () {
            return [
                { type: core.Renderer },
                { type: core.ElementRef }
            ];
        };
        NgxSummernoteViewDirective.propDecorators = {
            ngxSummernoteView: [{ type: core.Input }]
        };
        return NgxSummernoteViewDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */
    var NgxSummernoteModule = /** @class */ (function () {
        function NgxSummernoteModule() {
        }
        /**
         * @return {?}
         */
        NgxSummernoteModule.forRoot = /**
         * @return {?}
         */
            function () {
                return { ngModule: NgxSummernoteModule, providers: [] };
            };
        NgxSummernoteModule.decorators = [
            { type: core.NgModule, args: [{
                        declarations: [
                            NgxSummernoteDirective,
                            NgxSummernoteViewDirective
                        ],
                        exports: [
                            NgxSummernoteDirective,
                            NgxSummernoteViewDirective
                        ]
                    },] },
        ];
        return NgxSummernoteModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
     */

    exports.NgxSummernoteDirective = NgxSummernoteDirective;
    exports.NgxSummernoteViewDirective = NgxSummernoteViewDirective;
    exports.NgxSummernoteModule = NgxSummernoteModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXN1bW1lcm5vdGUudW1kLmpzLm1hcCIsInNvdXJjZXMiOltudWxsLCJuZzovL25neC1zdW1tZXJub3RlL2xpYi9uZ3gtc3VtbWVybm90ZS5kaXJlY3RpdmUudHMiLCJuZzovL25neC1zdW1tZXJub3RlL2xpYi9uZ3gtc3VtbWVybm90ZS12aWV3LmRpcmVjdGl2ZS50cyIsIm5nOi8vbmd4LXN1bW1lcm5vdGUvbGliL25neC1zdW1tZXJub3RlLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwiaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7XG4gICAgRGlyZWN0aXZlLFxuICAgIEVsZW1lbnRSZWYsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIGZvcndhcmRSZWYsXG4gICAgSW5wdXQsXG4gICAgTmdab25lLFxuICAgIE9uQ2hhbmdlcyxcbiAgICBPbkRlc3Ryb3ksXG4gICAgT25Jbml0LFxuICAgIE91dHB1dCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBvZiwgdGhyb3dFcnJvciB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgY2F0Y2hFcnJvciwgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5kZWNsYXJlIHZhciAkO1xuXG5ARGlyZWN0aXZlKHtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGlyZWN0aXZlLXNlbGVjdG9yXG4gICAgc2VsZWN0b3I6ICdbbmd4U3VtbWVybm90ZV0nLFxuICAgIHByb3ZpZGVyczogW3tcbiAgICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IE5neFN1bW1lcm5vdGVEaXJlY3RpdmUpLFxuICAgICAgICBtdWx0aTogdHJ1ZVxuICAgIH1dXG59KVxuZXhwb3J0IGNsYXNzIE5neFN1bW1lcm5vdGVEaXJlY3RpdmUgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgT25Jbml0LCBPbkRlc3Ryb3ksIE9uQ2hhbmdlcyB7XG4gICAgQElucHV0KCkgc2V0IG5neFN1bW1lcm5vdGUob3B0aW9uczogYW55KSB7XG4gICAgICAgIGlmIChvcHRpb25zLmJ1dHRvbnMpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ob3B0aW9ucy5idXR0b25zLCB0aGlzLl9vcHRpb25zLmJ1dHRvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBPYmplY3QuYXNzaWduKHRoaXMuX29wdGlvbnMsIG9wdGlvbnMpO1xuICAgIH1cbiAgICAvLyBzdW1tZXJub3RlTW9kZWwgZGlyZWN0aXZlIGFzIGlucHV0OiBzdG9yZSBpbml0aWFsIGVkaXRvciBjb250ZW50XG4gICAgQElucHV0KCkgc2V0IHN1bW1lcm5vdGVNb2RlbChjb250ZW50OiBhbnkpIHtcbiAgICAgICAgdGhpcy51cGRhdGVFZGl0b3IoY29udGVudCk7XG4gICAgfVxuXG4gICAgLy8gc3VtbWVybm90ZU1vZGVsIGRpcmVjdGl2ZSBhcyBvdXRwdXQ6IHVwZGF0ZSBtb2RlbCBpZiBlZGl0b3IgY29udGVudENoYW5nZWRcbiAgICBAT3V0cHV0KCkgc3VtbWVybm90ZU1vZGVsQ2hhbmdlOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICAgIEBPdXRwdXQoKSBpbWFnZVVwbG9hZDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAgIC8vIHN1bW1lcm5vdGVJbml0IGRpcmVjdGl2ZSBhcyBvdXRwdXQ6IHNlbmQgbWFudWFsIGVkaXRvciBpbml0aWFsaXphdGlvblxuICAgIEBPdXRwdXQoKSBzdW1tZXJub3RlSW5pdDogRXZlbnRFbWl0dGVyPE9iamVjdD4gPSBuZXcgRXZlbnRFbWl0dGVyPE9iamVjdD4oKTtcblxuICAgIEBPdXRwdXQoKSBibHVyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgQElucHV0KCkgbmd4U3VtbWVybm90ZURpc2FibGVkOiBib29sZWFuO1xuXG4gICAgcHJpdmF0ZSBfb3B0aW9uczogYW55ID0ge1xuICAgICAgICBpbW1lZGlhdGVBbmd1bGFyTW9kZWxVcGRhdGU6IGZhbHNlLFxuICAgICAgICBhbmd1bGFySWdub3JlQXR0cnM6IG51bGwsXG4gICAgICAgIHBsYWNlaG9sZGVyOiAnJyxcbiAgICAgICAgdGFic2l6ZTogMixcbiAgICAgICAgaGVpZ2h0OiAxMDAsXG4gICAgICAgIHVwbG9hZEltYWdlUGF0aDogJycsXG4gICAgICAgIHRvb2xiYXI6IFtcbiAgICAgICAgICAgIC8vIFtncm91cE5hbWUsIFtsaXN0IG9mIGJ1dHRvbl1dXG4gICAgICAgICAgICBbJ21pc2MnLCBbJ2NvZGV2aWV3JywgJ3VuZG8nLCAncmVkbycsICdjb2RlQmxvY2snXV0sXG4gICAgICAgICAgICAvLyBbJ3N0eWxlJywgWydib2xkJywgJ2l0YWxpYycsICd1bmRlcmxpbmUnLCAnY2xlYXInXV0sXG4gICAgICAgICAgICBbJ2ZvbnQnLCBbJ2JvbGQnLCAnaXRhbGljJywgJ3VuZGVybGluZScsICdzdHJpa2V0aHJvdWdoJywgJ3N1cGVyc2NyaXB0JywgJ3N1YnNjcmlwdCcsICdjbGVhciddXSxcbiAgICAgICAgICAgIFsnZm9udHNpemUnLCBbJ2ZvbnRuYW1lJywgJ2ZvbnRzaXplJywgJ2NvbG9yJ11dLFxuICAgICAgICAgICAgWydwYXJhJywgWydzdHlsZTAnLCAndWwnLCAnb2wnLCAncGFyYWdyYXBoJywgJ2hlaWdodCddXSxcbiAgICAgICAgICAgIFsnaW5zZXJ0JywgWyd0YWJsZScsICdwaWN0dXJlJywgJ2xpbmsnLCAndmlkZW8nLCAnaHInXV0sXG4gICAgICAgIF0sXG4gICAgICAgIGZvbnROYW1lczogWydIZWx2ZXRpY2EnLCAnQXJpYWwnLCAnQXJpYWwgQmxhY2snLCAnQ29taWMgU2FucyBNUycsICdDb3VyaWVyIE5ldycsICdSb2JvdG8nLCAnVGltZXMnXSxcbiAgICAgICAgY2FsbGJhY2tzOiB7XG4gICAgICAgICAgICBvbkltYWdlVXBsb2FkOiAoZmlsZXMpID0+IHRoaXMudXBsb2FkSW1hZ2UoZmlsZXMpXG4gICAgICAgIH0sXG4gICAgICAgIGJ1dHRvbnM6IHtcbiAgICAgICAgICAgIGNvZGVCbG9jazogdGhpcy5jb2RlQmxvY2tCdXR0b24oKVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByaXZhdGUgU1BFQ0lBTF9UQUdTOiBzdHJpbmdbXSA9IFsnaW1nJywgJ2J1dHRvbicsICdpbnB1dCcsICdhJ107XG4gICAgcHJpdmF0ZSBJTk5FUl9IVE1MX0FUVFIgPSAnaW5uZXJIVE1MJztcbiAgICBwcml2YXRlIF9oYXNTcGVjaWFsVGFnOiBib29sZWFuO1xuICAgIHByaXZhdGUgXyRlbGVtZW50OiBhbnk7IC8vIGpxdWVyeSB3cmFwcGVkIGVsZW1lbnRcbiAgICBwcml2YXRlIF9lZGl0b3I6IGFueTsgLy8gZWRpdG9yIGVsZW1lbnRcbiAgICBwcml2YXRlIF9tb2RlbDogc3RyaW5nO1xuICAgIHByaXZhdGUgX29sZE1vZGVsOiBzdHJpbmcgPSBudWxsO1xuICAgIHByaXZhdGUgX2VkaXRvckluaXRpYWxpemVkOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoZWw6IEVsZW1lbnRSZWYsIHByaXZhdGUgem9uZTogTmdab25lLCBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudDogYW55ID0gZWwubmF0aXZlRWxlbWVudDtcblxuICAgICAgICAvLyBjaGVjayBpZiB0aGUgZWxlbWVudCBpcyBhIHNwZWNpYWwgdGFnXG4gICAgICAgIGlmICh0aGlzLlNQRUNJQUxfVEFHUy5pbmRleE9mKGVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuX2hhc1NwZWNpYWxUYWcgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8ganF1ZXJ5IHdyYXAgYW5kIHN0b3JlIGVsZW1lbnRcbiAgICAgICAgdGhpcy5fJGVsZW1lbnQgPSAoPGFueT4kKGVsZW1lbnQpKTtcbiAgICAgICAgdGhpcy56b25lID0gem9uZTtcbiAgICB9XG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5fb3B0aW9ucy50b29sYmFyXG4gICAgICAgIC8vIGNoZWNrIGlmIG91dHB1dCBzdW1tZXJub3RlSW5pdCBpcyBwcmVzZW50LiBNYXliZSBvYnNlcnZlcnMgaXMgcHJpdmF0ZSBhbmRcbiAgICAgICAgLy8gc2hvdWxkIG5vdCBiZSB1c2VkPz8gVE9ETyBob3cgdG8gYmV0dGVyIHRlc3QgdGhhdCBhbiBvdXRwdXQgZGlyZWN0aXZlIGlzIHByZXNlbnQuXG4gICAgICAgIGlmICghdGhpcy5zdW1tZXJub3RlSW5pdC5vYnNlcnZlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUVkaXRvcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gVE9ETyBub3Qgc3VyZSBpdCB3b3JrcyBub3cuLi5cbiAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVNYW51YWxDb250cm9sbGVyKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIGlmICh0aGlzLl9lZGl0b3JJbml0aWFsaXplZCAmJiBjaGFuZ2VzKSB7XG4gICAgICAgICAgICBpZiAoY2hhbmdlcy5uZ3hTdW1tZXJub3RlRGlzYWJsZWQgJiYgIWNoYW5nZXMubmd4U3VtbWVybm90ZURpc2FibGVkLmZpcnN0Q2hhbmdlICYmXG4gICAgICAgICAgICAgICAgY2hhbmdlcy5uZ3hTdW1tZXJub3RlRGlzYWJsZWQuY3VycmVudFZhbHVlICE9PSBjaGFuZ2VzLm5neFN1bW1lcm5vdGVEaXNhYmxlZC5wcmV2aW91c1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoYW5nZXMubmd4U3VtbWVybm90ZURpc2FibGVkLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5zdW1tZXJub3RlKCdkaXNhYmxlJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQuc3VtbWVybm90ZSgnZW5hYmxlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuZGVzdHJveUVkaXRvcigpO1xuICAgIH1cblxuICAgIC8vIEJlZ2luIENvbnRyb2xWYWx1ZUFjY2Vzb3IgbWV0aG9kcy5cbiAgICBvbkNoYW5nZSA9IChfKSA9PiB7IH07XG4gICAgb25Ub3VjaGVkID0gKCkgPT4geyB9O1xuXG4gICAgLy8gRm9ybSBtb2RlbCBjb250ZW50IGNoYW5nZWQuXG4gICAgd3JpdGVWYWx1ZShjb250ZW50OiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy51cGRhdGVFZGl0b3IoY29udGVudCk7XG4gICAgfVxuXG4gICAgcmVnaXN0ZXJPbkNoYW5nZShmbjogKF86IGFueSkgPT4gdm9pZCk6IHZvaWQgeyB0aGlzLm9uQ2hhbmdlID0gZm47IH1cbiAgICByZWdpc3Rlck9uVG91Y2hlZChmbjogKCkgPT4gdm9pZCk6IHZvaWQgeyB0aGlzLm9uVG91Y2hlZCA9IGZuOyB9XG5cbiAgICAvLyBVcGRhdGUgZWRpdG9yIHdpdGggbW9kZWwgY29udGVudHMuXG4gICAgcHJpdmF0ZSB1cGRhdGVFZGl0b3IoY29udGVudDogYW55KSB7XG4gICAgICAgIGlmIChKU09OLnN0cmluZ2lmeSh0aGlzLl9vbGRNb2RlbCkgPT09IEpTT04uc3RyaW5naWZ5KGNvbnRlbnQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9vbGRNb2RlbCA9IGNvbnRlbnQ7XG4gICAgICAgIHRoaXMuXyRlbGVtZW50Lmh0bWwoY29udGVudCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2VkaXRvckluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5zdW1tZXJub3RlKCdjb2RlJywgY29udGVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5odG1sKGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gdXBkYXRlIG1vZGVsIGlmIGVkaXRvciBjb250ZW50Q2hhbmdlZFxuICAgIHByaXZhdGUgdXBkYXRlTW9kZWwoY29udGVudD86IGFueSkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhcInVwZGF0ZSBtb2RlbFwiLCBjb250ZW50KVxuICAgICAgICB0aGlzLnpvbmUucnVuKCgpID0+IHtcbiAgICAgICAgICAgIGxldCBtb2RlbENvbnRlbnQ6IGFueSA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNTcGVjaWFsVGFnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlTm9kZXMgPSB0aGlzLl8kZWxlbWVudFswXS5hdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJzID0ge307XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF0dHJpYnV0ZU5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJOYW1lID0gYXR0cmlidXRlTm9kZXNbaV0ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29wdGlvbnMuYW5ndWxhcklnbm9yZUF0dHJzICYmIHRoaXMuX29wdGlvbnMuYW5ndWxhcklnbm9yZUF0dHJzLmluZGV4T2YoYXR0ck5hbWUpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYXR0cnNbYXR0ck5hbWVdID0gYXR0cmlidXRlTm9kZXNbaV0udmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuXyRlbGVtZW50WzBdLmlubmVySFRNTCkge1xuICAgICAgICAgICAgICAgICAgICBhdHRyc1t0aGlzLklOTkVSX0hUTUxfQVRUUl0gPSB0aGlzLl8kZWxlbWVudFswXS5pbm5lckhUTUw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbW9kZWxDb250ZW50ID0gYXR0cnM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJldHVybmVkSHRtbDogYW55ID0gY29udGVudCB8fCAnJztcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJldHVybmVkSHRtbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxDb250ZW50ID0gcmV0dXJuZWRIdG1sO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX29sZE1vZGVsID0gbW9kZWxDb250ZW50O1xuICAgICAgICAgICAgLy8gVXBkYXRlIHN1bW1lcm5vdGVNb2RlbFxuICAgICAgICAgICAgdGhpcy5zdW1tZXJub3RlTW9kZWxDaGFuZ2UuZW1pdChtb2RlbENvbnRlbnQpO1xuICAgICAgICAgICAgLy8gVXBkYXRlIGZvcm0gbW9kZWwuXG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKGNvbnRlbnQpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIGlmICghdGhpcy5fJGVsZW1lbnQpIHsgcmV0dXJuOyB9XG5cbiAgICAgICAgdGhpcy5fJGVsZW1lbnQub24oJ3N1bW1lcm5vdGUuaW5pdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlTW9kZWwoKTtcbiAgICAgICAgICAgIH0sIDApO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl8kZWxlbWVudC5vbignc3VtbWVybm90ZS5jaGFuZ2UnLCBmdW5jdGlvbiAoZXZlbnQsIGNvbnRlbnRzLCAkZWRpdGFibGUpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNlbGYudXBkYXRlTW9kZWwoY29udGVudHMpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuXyRlbGVtZW50Lm9uKCdzdW1tZXJub3RlLmJsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLm9uVG91Y2hlZCgpO1xuICAgICAgICAgICAgICAgIHNlbGYuYmx1ci5lbWl0KCk7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMuX29wdGlvbnMuaW1tZWRpYXRlQW5ndWxhck1vZGVsVXBkYXRlKSB7XG4gICAgICAgICAgICB0aGlzLl9lZGl0b3Iub24oJ2tleXVwJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnVwZGF0ZU1vZGVsKCk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlRWRpdG9yKCkge1xuICAgICAgICBpZiAodGhpcy5fZWRpdG9ySW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0Q29udGVudCh0cnVlKTtcblxuICAgICAgICBcbiAgICAgICAgLy8gdGhpcy5pbml0TGlzdGVuZXJzKCk7IC8vIGlzc3VlICMzMSBcblxuICAgICAgICAvLyBpbml0IGVkaXRvclxuICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fZWRpdG9yID0gdGhpcy5fJGVsZW1lbnQuc3VtbWVybm90ZSh0aGlzLl9vcHRpb25zKS5kYXRhKCdzdW1tZXJub3RlJykuJG5vdGU7XG4gICAgICAgICAgICB0aGlzLmluaXRMaXN0ZW5lcnMoKTsgLy8gaXNzdWUgIzMxXG4gICAgICAgICAgICBpZiAodGhpcy5uZ3hTdW1tZXJub3RlRGlzYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5zdW1tZXJub3RlKCdkaXNhYmxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX2VkaXRvckluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldEh0bWwoKSB7XG4gICAgICAgIHRoaXMuXyRlbGVtZW50LnN1bW1lcm5vdGUoJ2NvZGUnLCB0aGlzLl9tb2RlbCB8fCAnJywgdHJ1ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRDb250ZW50KGZpcnN0VGltZSA9IGZhbHNlKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwic2V0IGNvbnRlbnRcIiwgZmlyc3RUaW1lLCB0aGlzLl9vbGRNb2RlbCwgdGhpcy5fbW9kZWwpXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgICAgICAvLyBTZXQgaW5pdGlhbCBjb250ZW50XG4gICAgICAgIGlmICh0aGlzLl9tb2RlbCB8fCB0aGlzLl9tb2RlbCA9PT0gJycpIHtcbiAgICAgICAgICAgIHRoaXMuX29sZE1vZGVsID0gdGhpcy5fbW9kZWw7XG4gICAgICAgICAgICBpZiAodGhpcy5faGFzU3BlY2lhbFRhZykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ3M6IE9iamVjdCA9IHRoaXMuX21vZGVsO1xuICAgICAgICAgICAgICAgIC8vIGFkZCB0YWdzIG9uIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBpZiAodGFncykge1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYXR0ciBpbiB0YWdzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFncy5oYXNPd25Qcm9wZXJ0eShhdHRyKSAmJiBhdHRyICE9PSB0aGlzLklOTkVSX0hUTUxfQVRUUikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50LmF0dHIoYXR0ciwgdGFnc1thdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAodGFncy5oYXNPd25Qcm9wZXJ0eSh0aGlzLklOTkVSX0hUTUxfQVRUUikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50WzBdLmlubmVySFRNTCA9IHRhZ3NbdGhpcy5JTk5FUl9IVE1MX0FUVFJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNldEh0bWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZGVzdHJveUVkaXRvcigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2VkaXRvckluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICB0aGlzLl9lZGl0b3Iub2ZmKCdrZXl1cCcpO1xuICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQuc3VtbWVybm90ZSgnZGVzdHJveScpOyAvLyBUT0RPIG5vdCBzdXJlIGl0IHdvcmtzIG5vdy4uLlxuICAgICAgICAgICAgdGhpcy5fZWRpdG9ySW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0RWRpdG9yKCkge1xuICAgICAgICBpZiAodGhpcy5fJGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl8kZWxlbWVudC5zdW1tZXJub3RlLmJpbmQodGhpcy5fJGVsZW1lbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gc2VuZCBtYW51YWwgZWRpdG9yIGluaXRpYWxpemF0aW9uXG4gICAgLy8gVE9ETyBub3Qgc3VyZSBpdCB3b3JrcyBub3cuLi5cbiAgICBwcml2YXRlIGdlbmVyYXRlTWFudWFsQ29udHJvbGxlcigpIHtcbiAgICAgICAgY29uc3QgY29udHJvbHMgPSB7XG4gICAgICAgICAgICBpbml0aWFsaXplOiB0aGlzLmNyZWF0ZUVkaXRvci5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgZGVzdHJveTogdGhpcy5kZXN0cm95RWRpdG9yLmJpbmQodGhpcyksXG4gICAgICAgICAgICBnZXRFZGl0b3I6IHRoaXMuZ2V0RWRpdG9yLmJpbmQodGhpcyksXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc3VtbWVybm90ZUluaXQuZW1pdChjb250cm9scyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyB1cGxvYWRJbWFnZShmaWxlcykge1xuICAgICAgICBjb25zdCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIHRoaXMuaW1hZ2VVcGxvYWQuZW1pdCh7IHVwbG9hZGluZzogdHJ1ZSB9KTtcbiAgICAgICAgZGF0YS5hcHBlbmQoJ2ltYWdlJywgZmlsZXNbMF0pO1xuICAgICAgICBpZiAodGhpcy5fb3B0aW9ucy51cGxvYWRJbWFnZVBhdGgpIHtcbiAgICAgICAgICAgIHRoaXMuaHR0cC5wb3N0KHRoaXMuX29wdGlvbnMudXBsb2FkSW1hZ2VQYXRoLCBkYXRhKVxuICAgICAgICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICAgICAgICBtYXAoKHJlc3BvbnNlOiB7IHBhdGg6IHN0cmluZyB9KSA9PiByZXNwb25zZSAmJiB0eXBlb2YgcmVzcG9uc2UucGF0aCA9PT0gJ3N0cmluZycgJiYgcmVzcG9uc2UucGF0aCksXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoRXJyb3IoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKCdBbiBlcnJvciBvY2N1cmVkIHdoaWxlIHVwbG9hZGluZycgKyBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvZignJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZGF0YUluID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFJbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQuc3VtbWVybm90ZSgnaW5zZXJ0SW1hZ2UnLCBkYXRhSW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZVVwbG9hZC5lbWl0KHsgdXBsb2FkaW5nOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0RnJvbURhdGFVUkwoZmlsZXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnRGcm9tRGF0YVVSTChmaWxlcyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmluc2VydEZyb21EYXRhVVJMKGZpbGVzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGluc2VydEZyb21EYXRhVVJMKGZpbGVzKSB7XG4gICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGVzWzBdKTtcbiAgICAgICAgcmVhZGVyLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50LnN1bW1lcm5vdGUoJ2luc2VydEltYWdlJywgcmVhZGVyLnJlc3VsdCk7XG4gICAgICAgICAgICB0aGlzLmltYWdlVXBsb2FkLmVtaXQoeyB1cGxvYWRpbmc6IGZhbHNlLCBlbmNvZGluZzogJ2Jhc2U2NCcgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJlYWRlci5vbmVycm9yID0gZXJyb3IgPT4gY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfVxuXG5cbiAgICBwcml2YXRlIGNvZGVCbG9ja0J1dHRvbigpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICBjb25zdCB1aSA9ICQuc3VtbWVybm90ZS51aTtcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBidXR0b25cbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IHVpLmJ1dHRvbih7XG4gICAgICAgICAgICAgICAgY29udGVudHM6ICdDb2RlIGJsb2NrJyxcbiAgICAgICAgICAgICAgICB0b29sdGlwOiAnQWRkIHJhdyBjb2RlJyxcbiAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRUZXh0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGJlbG93IGNvZGUgd2lsbCBjb3B5IHRoZSBzZWxlY3RlZCBibG9jayBhbmQgYWRkIGl0IGludG8gb3VyIGNvZGU9YmxvY2tcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkVGV4dCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RlVGV4dCA9IHNlbGVjdGVkVGV4dCA/IHNlbGVjdGVkVGV4dCA6IGBQbGFjZSB5b3VyIGNvZGUgaGVyZS5gO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RlQmxvY2sgPSBgPHByZSBjbGFzcz1cImNvZGUtYmxvY2tcIiBzdHlsZT1cImZvbnQtZmFtaWx5OiBNZW5sbywgTW9uYWNvLCBDb25zb2xhcywgJ0NvdXJpZXIgTmV3JywgbW9ub3NwYWNlOyBmb250LXNpemU6IDEycHg7IHBhZGRpbmc6IDE0cHggMTJweDsgbWFyZ2luLWJvdHRvbTogMTBweDsgbGluZS1oZWlnaHQ6IDEuNDI4NTc7IHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZDsgYmFja2dyb3VuZC1jb2xvcjogcmdiKDI1MCwgMjUxLCAyNTMpOyBib3JkZXI6IDFweCBzb2xpZCByZ2IoMjM0LCAyMzYsIDI0MCk7IGJvcmRlci1yYWRpdXM6IDRweDsgY29sb3I6ICM2MGEwYjBcIj48c3BhbiBzdHlsZT1cIndoaXRlLXNwYWNlOiBwcmUtd3JhcDtcIj4ke2NvZGVUZXh0fTwvc3Bhbj48L3ByZT5gO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuaW52b2tlKCdlZGl0b3IucGFzdGVIVE1MJywgY29kZUJsb2NrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGJ1dHRvbi5yZW5kZXIoKTsgICAvLyByZXR1cm4gYnV0dG9uIGFzIGpxdWVyeSBvYmplY3RcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgRGlyZWN0aXZlLCBJbnB1dCwgRWxlbWVudFJlZiwgUmVuZGVyZXIsIEFmdGVyVmlld0luaXRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmRlY2xhcmUgdmFyICQ7XG5cbkBEaXJlY3RpdmUoe1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpkaXJlY3RpdmUtc2VsZWN0b3JcbiAgICBzZWxlY3RvcjogJ1tuZ3hTdW1tZXJub3RlVmlld10nXG59KVxuZXhwb3J0IGNsYXNzIE5neFN1bW1lcm5vdGVWaWV3RGlyZWN0aXZlIGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCB7XG4gICAgQElucHV0KCkgc2V0IG5neFN1bW1lcm5vdGVWaWV3KGNvbnRlbnQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLl9lbGVtZW50LmlubmVySFRNTCA9IGNvbnRlbnQgfHwgJyc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfZWxlbWVudDogYW55O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyLFxuICAgICAgICBlbGVtZW50OiBFbGVtZW50UmVmXG4gICAgKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBlbGVtZW50Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgfVxuXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldEVsZW1lbnRDbGFzcyh0aGlzLl9lbGVtZW50LCAnbmd4LXN1bW1lcm5vdGUtdmlldycsIHRydWUpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE5nTW9kdWxlLCBNb2R1bGVXaXRoUHJvdmlkZXJzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOZ3hTdW1tZXJub3RlRGlyZWN0aXZlIH0gZnJvbSAnLi9uZ3gtc3VtbWVybm90ZS5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgTmd4U3VtbWVybm90ZVZpZXdEaXJlY3RpdmUgfSBmcm9tICcuL25neC1zdW1tZXJub3RlLXZpZXcuZGlyZWN0aXZlJztcblxuQE5nTW9kdWxlKHtcbiAgZGVjbGFyYXRpb25zOiBbXG4gICAgTmd4U3VtbWVybm90ZURpcmVjdGl2ZSxcbiAgICBOZ3hTdW1tZXJub3RlVmlld0RpcmVjdGl2ZVxuICBdLFxuICBleHBvcnRzOiBbXG4gICAgTmd4U3VtbWVybm90ZURpcmVjdGl2ZSxcbiAgICBOZ3hTdW1tZXJub3RlVmlld0RpcmVjdGl2ZVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIE5neFN1bW1lcm5vdGVNb2R1bGUge1xuICBwdWJsaWMgc3RhdGljIGZvclJvb3QoKTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgcmV0dXJuIHtuZ01vZHVsZTogTmd4U3VtbWVybm90ZU1vZHVsZSwgIHByb3ZpZGVyczogW119O1xuICB9XG59XG4iXSwibmFtZXMiOlsiaHR0cCIsIkV2ZW50RW1pdHRlciIsIm1hcCIsImNhdGNoRXJyb3IiLCJ0aHJvd0Vycm9yIiwib2YiLCJEaXJlY3RpdmUiLCJOR19WQUxVRV9BQ0NFU1NPUiIsImZvcndhcmRSZWYiLCJFbGVtZW50UmVmIiwiTmdab25lIiwiSHR0cENsaWVudCIsIklucHV0IiwiT3V0cHV0IiwiUmVuZGVyZXIiLCJOZ01vZHVsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0lBQUE7Ozs7Ozs7Ozs7Ozs7O0FBY0EsYUE2Q2dCLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTO1FBQ3ZELE9BQU8sS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLFVBQVUsT0FBTyxFQUFFLE1BQU07WUFDckQsU0FBUyxTQUFTLENBQUMsS0FBSyxJQUFJLElBQUk7Z0JBQUUsSUFBSSxD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RSxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztvQkFDeEMsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO3dCQUNULEtBQUssQ0FBQyxDQUFDO3dCQUFDLEtBQUssQ0FBQzs0QkFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDOzRCQUFDLE1BQU07d0JBQzlCLEtBQUssQ0FBQzs0QkFBRSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7NEJBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDO3dCQUN4RCxLQUFLLENBQUM7NEJBQUUsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDOzRCQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQUMsU0FBUzt3QkFDakQsS0FBSyxDQUFDOzRCQUFFLEVBQUUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDOzRCQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7NEJBQUMsU0FBUzt3QkFDakQ7NEJBQ0ksSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFO2dDQUFFLENBQUMsR0FBRyxDQUFDLENBQUM7Z0NBQUMsU0FBUzs2QkFBRTs0QkFDNUcsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFD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