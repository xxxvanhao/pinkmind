!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("ngx-summernote",["exports","@angular/common/http","@angular/core","@angular/forms","rxjs","rxjs/operators"],t):t(e["ngx-summernote"]={},e.ng.common.http,e.ng.core,e.ng.forms,e.rxjs,e.rxjs.operators)}(this,function(e,t,i,n,r,l){"use strict";function m(n,o){var r,i,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(s=2&e[0]?i["return"]:e[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=o.call(n,a)}catch(t){e=[6,t],i=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}var o=function(){function e(e,t,n){var o=this;this.zone=t,this.http=n,this.summernoteModelChange=new i.EventEmitter,this.imageUpload=new i.EventEmitter,this.summernoteInit=new i.EventEmitter,this.blur=new i.EventEmitter,this._options={immediateAngularModelUpdate:!1,angularIgnoreAttrs:null,placeholder:"",tabsize:2,height:100,uploadImagePath:"",toolbar:[["misc",["codeview","undo","redo","codeBlock"]],["font",["bold","italic","underline","strikethrough","superscript","subscript","clear"]],["fontsize",["fontname","fontsize","color"]],["para",["style0","ul","ol","paragraph","height"]],["insert",["table","picture","link","video","hr"]]],fontNames:["Helvetica","Arial","Arial Black","Comic Sans MS","Courier New","Roboto","Times"],callbacks:{onImageUpload:function(e){return o.uploadImage(e)}},buttons:{codeBlock:this.codeBlockButton()}},this.SPECIAL_TAGS=["img","button","input","a"],this.INNER_HTML_ATTR="innerHTML",this._oldModel=null,this.onChange=function(e){},this.onTouched=function(){};var r=e.nativeElement;-1!==this.SPECIAL_TAGS.indexOf(r.tagName.toLowerCase())&&(this._hasSpecialTag=!0),this._$element=$(r),this.zone=t}return Object.defineProperty(e.prototype,"ngxSummernote",{set:function(e){e.buttons&&Object.assign(e.buttons,this._options.buttons),this._options=Object.assign(this._options,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"summernoteModel",{set:function(e){this.updateEditor(e)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this._options.toolbar,this.summernoteInit.observers.length?this.generateManualController():this.createEditor()},e.prototype.ngOnChanges=function(e){this._editorInitialized&&e&&e.ngxSummernoteDisabled&&!e.ngxSummernoteDisabled.firstChange&&e.ngxSummernoteDisabled.currentValue!==e.ngxSummernoteDisabled.previousValue&&(e.ngxSummernoteDisabled.currentValue?this._$element.summernote("disable"):this._$element.summernote("enable"))},e.prototype.ngOnDestroy=function(){this.destroyEditor()},e.prototype.writeValue=function(e){this.updateEditor(e)},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.updateEditor=function(e){JSON.stringify(this._oldModel)!==JSON.stringify(e)&&(this._oldModel=e,this._$element.html(e),this._editorInitialized?this._$element.summernote("code",e):this._$element.html(e))},e.prototype.updateModel=function(s){var a=this;this.zone.run(function(){var e=null;if(a._hasSpecialTag){for(var t=a._$element[0].attributes,n={},o=0;o<t.length;o++){var r=t[o].name;a._options.angularIgnoreAttrs&&-1!==a._options.angularIgnoreAttrs.indexOf(r)||(n[r]=t[o].value)}a._$element[0].innerHTML&&(n[a.INNER_HTML_ATTR]=a._$element[0].innerHTML),e=n}else{var i=s||"";"string"==typeof i&&(e=i)}a._oldModel=e,a.summernoteModelChange.emit(e),a.onChange(s)})},e.prototype.initListeners=function(){var o=this;this._$element&&(this._$element.on("summernote.init",function(){setTimeout(function(){o.updateModel()},0)}),this._$element.on("summernote.change",function(e,t,n){setTimeout(function(){o.updateModel(t)},0)}),this._$element.on("summernote.blur",function(){setTimeout(function(){o.onTouched(),o.blur.emit()},0)}),this._options.immediateAngularModelUpdate&&this._editor.on("keyup",function(){setTimeout(function(){o.updateModel()},0)}))},e.prototype.createEditor=function(){var e=this;this._editorInitialized||(this.setContent(!0),this.zone.runOutsideAngular(function(){e._editor=e._$element.summernote(e._options).data("summernote").$note,e.initListeners(),e.ngxSummernoteDisabled&&e._$element.summernote("disable")}),this._editorInitialized=!0)},e.prototype.setHtml=function(){this._$element.summernote("code",this._model||"",!0)},e.prototype.setContent=function(e){void 0===e&&(e=!1);if(this._model||""===this._model)if(this._oldModel=this._model,this._hasSpecialTag){var t=this._model;if(t){for(var n in t)t.hasOwnProperty(n)&&n!==this.INNER_HTML_ATTR&&this._$element.attr(n,t[n]);t.hasOwnProperty(this.INNER_HTML_ATTR)&&(this._$element[0].innerHTML=t[this.INNER_HTML_ATTR])}}else this.setHtml()},e.prototype.destroyEditor=function(){this._editorInitialized&&(this._editor.off("keyup"),this._$element.summernote("destroy"),this._editorInitialized=!1)},e.prototype.getEditor=function(){return this._$element?this._$element.summernote.bind(this._$element):null},e.prototype.generateManualController=function(){var e={initialize:this.createEditor.bind(this),destroy:this.destroyEditor.bind(this),getEditor:this.getEditor.bind(this)};this.summernoteInit.emit(e)},e.prototype.uploadImage=function(o){return t=this,u=function(){var t,n=this;return m(this,function(e){return t=new FormData,this.imageUpload.emit({uploading:!0}),t.append("image",o[0]),this._options.uploadImagePath?this.http.post(this._options.uploadImagePath,t).pipe(l.map(function(e){return e&&"string"==typeof e.path&&e.path}),l.catchError(function(e){return r.throwError("An error occured while uploading"+e),r.of("")})).subscribe(function(e){e?(n._$element.summernote("insertImage",e),n.imageUpload.emit({uploading:!1})):n.insertFromDataURL(o)},function(e){n.insertFromDataURL(o)}):this.insertFromDataURL(o),[2]})},new((a=s=void 0)||(a=Promise))(function(e,n){function o(e){try{i(u.next(e))}catch(t){n(t)}}function r(e){try{i(u["throw"](e))}catch(t){n(t)}}function i(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(o,r)}i((u=u.apply(t,s||[])).next())});var t,s,a,u},e.prototype.insertFromDataURL=function(e){var t=this,n=new FileReader;n.readAsDataURL(e[0]),n.onload=function(){t._$element.summernote("insertImage",n.result),t.imageUpload.emit({uploading:!1,encoding:"base64"})},n.onerror=function(e){return console.error(e)}},e.prototype.codeBlockButton=function(){return function(n){return $.summernote.ui.button({contents:"Code block",tooltip:"Add raw code",click:function(){var e=null;window.getSelection&&(e=window.getSelection().toString().replace(/^\s+|\s+$/g,""));var t='<pre class="code-block" style="font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: 12px; padding: 14px 12px; margin-bottom: 10px; line-height: 1.42857; word-break: break-all; overflow-wrap: break-word; background-color: rgb(250, 251, 253); border: 1px solid rgb(234, 236, 240); border-radius: 4px; color: #60a0b0"><span style="white-space: pre-wrap;">'+(e||"Place your code here.")+"</span></pre>";n.invoke("editor.pasteHTML",t)}}).render()}},e.decorators=[{type:i.Directive,args:[{selector:"[ngxSummernote]",providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:i.forwardRef(function(){return e}),multi:!0}]}]}],e.ctorParameters=function(){return[{type:i.ElementRef},{type:i.NgZone},{type:t.HttpClient}]},e.propDecorators={ngxSummernote:[{type:i.Input}],summernoteModel:[{type:i.Input}],summernoteModelChange:[{type:i.Output}],imageUpload:[{type:i.Output}],summernoteInit:[{type:i.Output}],blur:[{type:i.Output}],ngxSummernoteDisabled:[{type:i.Input}]},e}(),s=function(){function e(e,t){this.renderer=e,this._element=t.nativeElement}return Object.defineProperty(e.prototype,"ngxSummernoteView",{set:function(e){this._element.innerHTML=e||""},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){this.renderer.setElementClass(this._element,"ngx-summernote-view",!0)},e.decorators=[{type:i.Directive,args:[{selector:"[ngxSummernoteView]"}]}],e.ctorParameters=function(){return[{type:i.Renderer},{type:i.ElementRef}]},e.propDecorators={ngxSummernoteView:[{type:i.Input}]},e}(),a=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e.decorators=[{type:i.NgModule,args:[{declarations:[o,s],exports:[o,s]}]}],e}();e.NgxSummernoteDirective=o,e.NgxSummernoteViewDirective=s,e.NgxSummernoteModule=a,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-summernote.umd.min.js.map