import { __extends, __read, __spread } from 'tslib';
import { Injectable, Directive, Input, ElementRef, Optional, ChangeDetectorRef, Pipe, NgModule } from '@angular/core';
import { of, empty, timer, Subject } from 'rxjs';
import { expand, skip, filter } from 'rxjs/operators';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * @param {?} value
 * @return {?}
 */
function isDefined(value) {
    return typeof value !== 'undefined' && value !== null;
}
/**
 * @param {?} value
 * @return {?}
 */
function coerceBooleanProperty(value) {
    return value != null && "" + value !== 'false';
}
/**
 * @param {?} date
 * @return {?}
 */
function dateParser(date) {
    var /** @type {?} */ parsed = new Date(date);
    if (!Number.isNaN(parsed.valueOf())) {
        return parsed;
    }
    var /** @type {?} */ parts = String(date).match(/\d+/g);
    if (parts === null || parts.length <= 2) {
        return parsed;
    }
    else {
        var _a = __read(parts.map(function (x) { return parseInt(x, 10); })), firstP = _a[0], secondP = _a[1], restPs = _a.slice(2);
        return new Date(Date.UTC.apply(Date, __spread([firstP, secondP - 1], restPs)));
    }
}
var /** @type {?} */ MINUTE = 60;
var /** @type {?} */ HOUR = MINUTE * 60;
var /** @type {?} */ DAY = HOUR * 24;
var /** @type {?} */ WEEK = DAY * 7;
var /** @type {?} */ MONTH = DAY * 30;
var /** @type {?} */ YEAR = DAY * 365;

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * @abstract
 */
var  /**
 * @abstract
 */
TimeagoClock = /** @class */ (function () {
    function TimeagoClock() {
    }
    return TimeagoClock;
}());
var TimeagoDefaultClock = /** @class */ (function (_super) {
    __extends(TimeagoDefaultClock, _super);
    function TimeagoDefaultClock() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * @param {?} then
     * @return {?}
     */
    TimeagoDefaultClock.prototype.tick = /**
     * @param {?} then
     * @return {?}
     */
    function (then) {
        return of(0)
            .pipe(expand(function () {
            var /** @type {?} */ now = Date.now();
            var /** @type {?} */ seconds = Math.round(Math.abs(now - then) / 1000);
            var /** @type {?} */ period = seconds < MINUTE
                ? 1000
                : seconds < HOUR
                    ? 1000 * MINUTE
                    : seconds < DAY
                        ? 1000 * HOUR
                        : 0;
            return period ? timer(period) : empty();
        }), skip(1));
    };
    TimeagoDefaultClock.decorators = [
        { type: Injectable },
    ];
    return TimeagoDefaultClock;
}(TimeagoClock));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * To modify the text displayed, create a new instance of TimeagoIntl and
 * include it in a custom provider
 */
var TimeagoIntl = /** @class */ (function () {
    function TimeagoIntl() {
        /**
         * Stream that emits whenever the l10n strings are changed
         * Use this to notify directives if the l10n strings have changed after initialization.
         */
        this.changes = new Subject();
    }
    TimeagoIntl.decorators = [
        { type: Injectable },
    ];
    return TimeagoIntl;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var /** @type {?} */ defaultFormattter = function (then) {
    var /** @type {?} */ now = Date.now();
    var /** @type {?} */ seconds = Math.round(Math.abs(now - then) / 1000);
    var /** @type {?} */ suffix = then < now ? 'ago' : 'from now';
    var _a = __read(seconds < MINUTE
        ? [Math.round(seconds), 'second']
        : seconds < HOUR
            ? [Math.round(seconds / MINUTE), 'minute']
            : seconds < DAY
                ? [Math.round(seconds / HOUR), 'hour']
                : seconds < WEEK
                    ? [Math.round(seconds / DAY), 'day']
                    : seconds < MONTH
                        ? [Math.round(seconds / WEEK), 'week']
                        : seconds < YEAR
                            ? [Math.round(seconds / MONTH), 'month']
                            : [Math.round(seconds / YEAR), 'year'], 2), value = _a[0], unit = _a[1];
    return { value: value, unit: unit, suffix: suffix };
};
/**
 * @abstract
 */
var  /**
 * @abstract
 */
TimeagoFormatter = /** @class */ (function () {
    function TimeagoFormatter() {
    }
    return TimeagoFormatter;
}());
var TimeagoDefaultFormatter = /** @class */ (function (_super) {
    __extends(TimeagoDefaultFormatter, _super);
    function TimeagoDefaultFormatter() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * @param {?} then
     * @return {?}
     */
    TimeagoDefaultFormatter.prototype.format = /**
     * @param {?} then
     * @return {?}
     */
    function (then) {
        var _a = defaultFormattter(then), suffix = _a.suffix, value = _a.value, unit = _a.unit;
        return this.parse(value, unit, suffix);
    };
    /**
     * @param {?} value
     * @param {?} unit
     * @param {?} suffix
     * @return {?}
     */
    TimeagoDefaultFormatter.prototype.parse = /**
     * @param {?} value
     * @param {?} unit
     * @param {?} suffix
     * @return {?}
     */
    function (value, unit, suffix) {
        if (value !== 1) {
            unit += 's';
        }
        return value + ' ' + unit + ' ' + suffix;
    };
    TimeagoDefaultFormatter.decorators = [
        { type: Injectable },
    ];
    return TimeagoDefaultFormatter;
}(TimeagoFormatter));
var TimeagoCustomFormatter = /** @class */ (function (_super) {
    __extends(TimeagoCustomFormatter, _super);
    function TimeagoCustomFormatter(intl) {
        var _this = _super.call(this) || this;
        _this.intl = intl;
        return _this;
    }
    /**
     * @param {?} then
     * @return {?}
     */
    TimeagoCustomFormatter.prototype.format = /**
     * @param {?} then
     * @return {?}
     */
    function (then) {
        var _a = defaultFormattter(then), suffix = _a.suffix, value = _a.value, unit = _a.unit;
        return this.parse(value, unit, suffix, Date.now(), then);
    };
    /**
     * @param {?} value
     * @param {?} unit
     * @param {?} suffix
     * @param {?} now
     * @param {?} then
     * @return {?}
     */
    TimeagoCustomFormatter.prototype.parse = /**
     * @param {?} value
     * @param {?} unit
     * @param {?} suffix
     * @param {?} now
     * @param {?} then
     * @return {?}
     */
    function (value, unit, suffix, now, then) {
        /** convert weeks to days if strings don't handle weeks */
        if (unit === 'week' && !this.intl.strings.week && !this.intl.strings.weeks) {
            var /** @type {?} */ days = Math.round(Math.abs(now - then) / (1000 * 60 * 60 * 24));
            value = days;
            unit = 'day';
        }
        /**
         * create a normalize function for given value
         */
        var /** @type {?} */ normalize = this.normalizeFn(value, now - then, this.intl.strings.numbers);
        /**
         * The eventual return value stored in an array so that the wordSeparator can be used
         */
        var /** @type {?} */ dateString = [];
        /** handle prefixes */
        if (suffix === 'ago' && this.intl.strings.prefixAgo) {
            dateString.push(normalize(this.intl.strings.prefixAgo));
        }
        if (suffix === 'from now' && this.intl.strings.prefixFromNow) {
            dateString.push(normalize(this.intl.strings.prefixFromNow));
        }
        /**
         * Handle Main number and unit
         */
        var /** @type {?} */ isPlural = value > 1;
        if (isPlural) {
            var /** @type {?} */ stringFn = this.intl.strings[unit + 's'] || this.intl.strings[unit] || '%d ' + unit;
            dateString.push(normalize(stringFn));
        }
        else {
            var /** @type {?} */ stringFn = this.intl.strings[unit] || this.intl.strings[unit + 's'] || '%d ' + unit;
            dateString.push(normalize(stringFn));
        }
        /** Handle Suffixes */
        if (suffix === 'ago' && this.intl.strings.suffixAgo) {
            dateString.push(normalize(this.intl.strings.suffixAgo));
        }
        if (suffix === 'from now' && this.intl.strings.suffixFromNow) {
            dateString.push(normalize(this.intl.strings.suffixFromNow));
        }
        /**
         * join the array into a string and return it
         */
        var /** @type {?} */ wordSeparator = typeof this.intl.strings.wordSeparator === 'string' ? this.intl.strings.wordSeparator : ' ';
        return dateString.join(wordSeparator);
    };
    /**
     * If the numbers array is present, format numbers with it,
     * otherwise just cast the number to a string and return it
     * @param {?} numbers
     * @param {?} value
     * @return {?}
     */
    TimeagoCustomFormatter.prototype.normalizeNumber = /**
     * If the numbers array is present, format numbers with it,
     * otherwise just cast the number to a string and return it
     * @param {?} numbers
     * @param {?} value
     * @return {?}
     */
    function (numbers, value) {
        return numbers && numbers.length === 10
            ? String(value).split('')
                .map(function (digit) { return digit.match(/^[0-9]$/) ? numbers[parseInt(digit, 10)] : digit; })
                .join('')
            : String(value);
    };
    /**
     * Take a string or a function that takes number of days and returns a string
     * and provide a uniform API to create string parts
     * @param {?} value
     * @param {?} millisDelta
     * @param {?=} numbers
     * @return {?}
     */
    TimeagoCustomFormatter.prototype.normalizeFn = /**
     * Take a string or a function that takes number of days and returns a string
     * and provide a uniform API to create string parts
     * @param {?} value
     * @param {?} millisDelta
     * @param {?=} numbers
     * @return {?}
     */
    function (value, millisDelta, numbers) {
        var _this = this;
        return function (stringOrFn) {
            return typeof stringOrFn === 'function'
                ? stringOrFn(value, millisDelta).replace(/%d/g, _this.normalizeNumber(numbers, value))
                : stringOrFn.replace(/%d/g, _this.normalizeNumber(numbers, value));
        };
    };
    TimeagoCustomFormatter.decorators = [
        { type: Injectable },
    ];
    /** @nocollapse */
    TimeagoCustomFormatter.ctorParameters = function () { return [
        { type: TimeagoIntl }
    ]; };
    return TimeagoCustomFormatter;
}(TimeagoFormatter));

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var TimeagoDirective = /** @class */ (function () {
    function TimeagoDirective(intl, cd, formatter, element, clock) {
        var _this = this;
        this.cd = cd;
        this.clock = clock;
        /**
         * Emits on:
         * - Input change
         * - Intl change
         * - Clock tick
         */
        this.stateChanges = new Subject();
        this._live = true;
        if (intl) {
            this.intlSubscription = intl.changes.subscribe(function () { return _this.stateChanges.next(); });
        }
        this.stateChanges.subscribe(function () {
            _this.setContent(element.nativeElement, formatter.format(_this.date));
            _this.cd.markForCheck();
        });
    }
    Object.defineProperty(TimeagoDirective.prototype, "date", {
        /** The Date to display. An actual Date object or something that can be fed to new Date. */
        get: /**
         * The Date to display. An actual Date object or something that can be fed to new Date.
         * @return {?}
         */
        function () {
            return this._date;
        },
        set: /**
         * @param {?} date
         * @return {?}
         */
        function (date) {
            var _this = this;
            this._date = dateParser(date).valueOf();
            if (this._date) {
                if (this.clockSubscription) {
                    this.clockSubscription.unsubscribe();
                    this.clockSubscription = undefined;
                }
                this.clockSubscription = this.clock.tick(date)
                    .pipe(filter(function () { return _this.live; }, this))
                    .subscribe(function () { return _this.stateChanges.next(); });
            }
            else {
                throw new SyntaxError("Wrong parameter in TimeagoDirective. Expected a valid date, received: " + date);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimeagoDirective.prototype, "live", {
        /** If the directive should update itself over time */
        get: /**
         * If the directive should update itself over time
         * @return {?}
         */
        function () {
            return this._live;
        },
        set: /**
         * @param {?} live
         * @return {?}
         */
        function (live) {
            this._live = coerceBooleanProperty(live);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} changes
     * @return {?}
     */
    TimeagoDirective.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.stateChanges.next();
    };
    /**
     * @param {?} node
     * @param {?} content
     * @return {?}
     */
    TimeagoDirective.prototype.setContent = /**
     * @param {?} node
     * @param {?} content
     * @return {?}
     */
    function (node, content) {
        if (isDefined(node.textContent)) {
            node.textContent = content;
        }
        else {
            node.data = content;
        }
    };
    /**
     * @return {?}
     */
    TimeagoDirective.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.intlSubscription) {
            this.intlSubscription.unsubscribe();
            this.intlSubscription = undefined;
        }
        if (this.clockSubscription) {
            this.clockSubscription.unsubscribe();
            this.clockSubscription = undefined;
        }
        this.stateChanges.complete();
    };
    TimeagoDirective.decorators = [
        { type: Directive, args: [{
                    selector: '[timeago]',
                    exportAs: 'timeago',
                },] },
    ];
    /** @nocollapse */
    TimeagoDirective.ctorParameters = function () { return [
        { type: TimeagoIntl, decorators: [{ type: Optional }] },
        { type: ChangeDetectorRef },
        { type: TimeagoFormatter },
        { type: ElementRef },
        { type: TimeagoClock }
    ]; };
    TimeagoDirective.propDecorators = {
        date: [{ type: Input }],
        live: [{ type: Input }]
    };
    return TimeagoDirective;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var TimeagoPipe = /** @class */ (function () {
    function TimeagoPipe(intl, cd, formatter, clock) {
        var _this = this;
        this.formatter = formatter;
        this.clock = clock;
        this.live = true;
        /**
         * Emits on:
         * - Input change
         * - Intl change
         * - Clock tick
         */
        this.stateChanges = new Subject();
        if (intl) {
            this.intlSubscription = intl.changes.subscribe(function () { return _this.stateChanges.next(); });
        }
        this.stateChanges.subscribe(function () {
            _this.value = formatter.format(_this.date);
            cd.markForCheck();
        });
    }
    /**
     * @param {?} date
     * @param {...?} args
     * @return {?}
     */
    TimeagoPipe.prototype.transform = /**
     * @param {?} date
     * @param {...?} args
     * @return {?}
     */
    function (date) {
        var _this = this;
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var /** @type {?} */ _date = dateParser(date).valueOf();
        var /** @type {?} */ _live;
        _live = isDefined(args[0])
            ? coerceBooleanProperty(args[0])
            : this.live;
        if (this.date === _date && this.live === _live) {
            return this.value;
        }
        this.date = _date;
        this.live = _live;
        if (this.date) {
            if (this.clockSubscription) {
                this.clockSubscription.unsubscribe();
                this.clockSubscription = undefined;
            }
            this.clockSubscription = this.clock.tick(date)
                .pipe(filter(function () { return _this.live; }, this))
                .subscribe(function () { return _this.stateChanges.next(); });
            this.stateChanges.next();
        }
        else {
            throw new SyntaxError("Wrong parameter in TimeagoPipe. Expected a valid date, received: " + date);
        }
        return this.value;
    };
    /**
     * @return {?}
     */
    TimeagoPipe.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.intlSubscription) {
            this.intlSubscription.unsubscribe();
            this.intlSubscription = undefined;
        }
        if (this.clockSubscription) {
            this.clockSubscription.unsubscribe();
            this.clockSubscription = undefined;
        }
        this.stateChanges.complete();
    };
    TimeagoPipe.decorators = [
        { type: Injectable },
        { type: Pipe, args: [{
                    name: 'timeago',
                    pure: false,
                },] },
    ];
    /** @nocollapse */
    TimeagoPipe.ctorParameters = function () { return [
        { type: TimeagoIntl, decorators: [{ type: Optional }] },
        { type: ChangeDetectorRef },
        { type: TimeagoFormatter },
        { type: TimeagoClock }
    ]; };
    return TimeagoPipe;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var TimeagoModule = /** @class */ (function () {
    function TimeagoModule() {
    }
    /**
     * Use this method in your root module to provide the TimeagoModule
     */
    /**
     * Use this method in your root module to provide the TimeagoModule
     * @param {?=} config
     * @return {?}
     */
    TimeagoModule.forRoot = /**
     * Use this method in your root module to provide the TimeagoModule
     * @param {?=} config
     * @return {?}
     */
    function (config) {
        if (config === void 0) { config = {}; }
        return {
            ngModule: TimeagoModule,
            providers: [
                config.clock || { provide: TimeagoClock, useClass: TimeagoDefaultClock },
                config.intl || [],
                config.formatter || { provide: TimeagoFormatter, useClass: TimeagoDefaultFormatter },
            ],
        };
    };
    /**
     * Use this method in your other (non root) modules to import the directive/pipe
     */
    /**
     * Use this method in your other (non root) modules to import the directive/pipe
     * @param {?=} config
     * @return {?}
     */
    TimeagoModule.forChild = /**
     * Use this method in your other (non root) modules to import the directive/pipe
     * @param {?=} config
     * @return {?}
     */
    function (config) {
        if (config === void 0) { config = {}; }
        return {
            ngModule: TimeagoModule,
            providers: [
                config.clock || { provide: TimeagoClock, useClass: TimeagoDefaultClock },
                config.intl || [],
                config.formatter || { provide: TimeagoFormatter, useClass: TimeagoDefaultFormatter },
            ],
        };
    };
    TimeagoModule.decorators = [
        { type: NgModule, args: [{
                    declarations: [
                        TimeagoDirective,
                        TimeagoPipe,
                    ],
                    exports: [
                        TimeagoDirective,
                        TimeagoPipe,
                    ],
                },] },
    ];
    return TimeagoModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { TimeagoDirective, TimeagoPipe, TimeagoIntl, TimeagoClock, TimeagoDefaultClock, TimeagoFormatter, TimeagoDefaultFormatter, TimeagoCustomFormatter, TimeagoModule };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXRpbWVhZ28uanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC10aW1lYWdvL3V0aWwudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28uY2xvY2sudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28uaW50bC50cyIsIm5nOi8vbmd4LXRpbWVhZ28vdGltZWFnby5mb3JtYXR0ZXIudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28uZGlyZWN0aXZlLnRzIiwibmc6Ly9uZ3gtdGltZWFnby90aW1lYWdvLnBpcGUudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28ubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBpc0RlZmluZWQodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSAhPT0gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiB2YWx1ZSAhPSBudWxsICYmIGAke3ZhbHVlfWAgIT09ICdmYWxzZSc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRlUGFyc2VyKGRhdGU6IGFueSk6IERhdGUge1xuICBjb25zdCBwYXJzZWQgPSBuZXcgRGF0ZShkYXRlKTtcbiAgaWYgKCFOdW1iZXIuaXNOYU4ocGFyc2VkLnZhbHVlT2YoKSkpIHtcbiAgICByZXR1cm4gcGFyc2VkO1xuICB9XG5cbiAgY29uc3QgcGFydHM6IHN0cmluZ1tdID0gU3RyaW5nKGRhdGUpLm1hdGNoKC9cXGQrL2cpO1xuICBpZiAocGFydHMgPT09IG51bGwgfHwgcGFydHMubGVuZ3RoIDw9IDIpIHtcbiAgICByZXR1cm4gcGFyc2VkO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IFtmaXJzdFAsIHNlY29uZFAsIC4uLnJlc3RQc10gPSBwYXJ0cy5tYXAoeCA9PiBwYXJzZUludCh4LCAxMCkpO1xuICAgIHJldHVybiBuZXcgRGF0ZShEYXRlLlVUQyhmaXJzdFAsIHNlY29uZFAgLSAxLCAuLi5yZXN0UHMpKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgTUlOVVRFID0gNjA7XG5leHBvcnQgY29uc3QgSE9VUiA9IE1JTlVURSAqIDYwO1xuZXhwb3J0IGNvbnN0IERBWSA9IEhPVVIgKiAyNDtcbmV4cG9ydCBjb25zdCBXRUVLID0gREFZICogNztcbmV4cG9ydCBjb25zdCBNT05USCA9IERBWSAqIDMwO1xuZXhwb3J0IGNvbnN0IFlFQVIgPSBEQVkgKiAzNjU7XG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiwgZW1wdHksIHRpbWVyIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBleHBhbmQsIHNraXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBNSU5VVEUsIEhPVVIsIERBWSwgV0VFSywgTU9OVEgsIFlFQVIgfSBmcm9tICcuL3V0aWwnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVGltZWFnb0Nsb2NrIHtcbiAgYWJzdHJhY3QgdGljayh0aGVuOiBudW1iZXIpOiBPYnNlcnZhYmxlPGFueT47XG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBUaW1lYWdvRGVmYXVsdENsb2NrIGV4dGVuZHMgVGltZWFnb0Nsb2NrIHtcbiAgdGljayh0aGVuOiBudW1iZXIpOiBPYnNlcnZhYmxlPG51bWJlcj4ge1xuICAgIHJldHVybiBvZigwKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGV4cGFuZCgoKSA9PiB7XG4gICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICBjb25zdCBzZWNvbmRzID0gTWF0aC5yb3VuZChNYXRoLmFicyhub3cgLSB0aGVuKSAvIDEwMDApO1xuXG4gICAgICAgICAgY29uc3QgcGVyaW9kID1cbiAgICAgICAgICAgIHNlY29uZHMgPCBNSU5VVEVcbiAgICAgICAgICAgICAgPyAxMDAwXG4gICAgICAgICAgICAgIDogc2Vjb25kcyA8IEhPVVJcbiAgICAgICAgICAgICAgICA/IDEwMDAgKiBNSU5VVEVcbiAgICAgICAgICAgICAgICA6IHNlY29uZHMgPCBEQVlcbiAgICAgICAgICAgICAgICAgID8gMTAwMCAqIEhPVVJcbiAgICAgICAgICAgICAgICAgIDogMDtcblxuICAgICAgICAgIHJldHVybiBwZXJpb2QgPyB0aW1lcihwZXJpb2QpIDogZW1wdHkoKTtcbiAgICAgICAgfSksXG4gICAgICAgIHNraXAoMSlcbiAgICAgICk7XG4gIH1cbn1cbiIsImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFN0cmluZ09yRm4sIE51bWJlckFycmF5IH0gZnJvbSAnLi90aW1lYWdvLmZvcm1hdHRlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUwxMG5zU3RyaW5ncyB7XG4gIHByZWZpeEFnbz86IFN0cmluZ09yRm47XG4gIHByZWZpeEZyb21Ob3c/OiBTdHJpbmdPckZuO1xuICBzdWZmaXhBZ28/OiBTdHJpbmdPckZuO1xuICBzdWZmaXhGcm9tTm93PzogU3RyaW5nT3JGbjtcbiAgc2Vjb25kPzogU3RyaW5nT3JGbjtcbiAgc2Vjb25kcz86IFN0cmluZ09yRm47XG4gIG1pbnV0ZT86IFN0cmluZ09yRm47XG4gIG1pbnV0ZXM/OiBTdHJpbmdPckZuO1xuICBob3VyPzogU3RyaW5nT3JGbjtcbiAgaG91cnM/OiBTdHJpbmdPckZuO1xuICBkYXk/OiBTdHJpbmdPckZuO1xuICBkYXlzPzogU3RyaW5nT3JGbjtcbiAgd2Vlaz86IFN0cmluZ09yRm47XG4gIHdlZWtzPzogU3RyaW5nT3JGbjtcbiAgbW9udGg/OiBTdHJpbmdPckZuO1xuICBtb250aHM/OiBTdHJpbmdPckZuO1xuICB5ZWFyPzogU3RyaW5nT3JGbjtcbiAgeWVhcnM/OiBTdHJpbmdPckZuO1xuICB3b3JkU2VwYXJhdG9yPzogc3RyaW5nO1xuICBudW1iZXJzPzogTnVtYmVyQXJyYXk7XG59O1xuXG4vKipcbiAqIFRvIG1vZGlmeSB0aGUgdGV4dCBkaXNwbGF5ZWQsIGNyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBUaW1lYWdvSW50bCBhbmRcbiAqIGluY2x1ZGUgaXQgaW4gYSBjdXN0b20gcHJvdmlkZXJcbiAqL1xuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFRpbWVhZ29JbnRsIHtcblxuICBzdHJpbmdzOiBJTDEwbnNTdHJpbmdzO1xuXG4gIC8qKlxuICAgKiBTdHJlYW0gdGhhdCBlbWl0cyB3aGVuZXZlciB0aGUgbDEwbiBzdHJpbmdzIGFyZSBjaGFuZ2VkXG4gICAqIFVzZSB0aGlzIHRvIG5vdGlmeSBkaXJlY3RpdmVzIGlmIHRoZSBsMTBuIHN0cmluZ3MgaGF2ZSBjaGFuZ2VkIGFmdGVyIGluaXRpYWxpemF0aW9uLlxuICAgKi9cbiAgcmVhZG9ubHkgY2hhbmdlczogU3ViamVjdDx2b2lkPiA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG59XG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVGltZWFnb0ludGwgfSBmcm9tICcuL3RpbWVhZ28uaW50bCc7XG5pbXBvcnQgeyBNSU5VVEUsIEhPVVIsIERBWSwgV0VFSywgTU9OVEgsIFlFQVIgfSBmcm9tICcuL3V0aWwnO1xuXG5leHBvcnQgdHlwZSBVbml0ID0gJ3NlY29uZCcgfCAnbWludXRlJyB8ICdob3VyJyB8ICdkYXknIHwgJ3dlZWsnIHwgJ21vbnRoJyB8ICd5ZWFyJztcblxuZXhwb3J0IHR5cGUgU3VmZml4ID0gJ2FnbycgfCAnZnJvbSBub3cnO1xuXG5leHBvcnQgdHlwZSBTdHJpbmdPckZuID0gKCh2YWx1ZTogbnVtYmVyLCBtaWxsaXNEZWx0YTogIG51bWJlcikgPT4gc3RyaW5nKSB8IHN0cmluZztcblxuZXhwb3J0IHR5cGUgTnVtYmVyQXJyYXkgPSBbIHN0cmluZywgc3RyaW5nLCBzdHJpbmcsIHN0cmluZywgc3RyaW5nLCBzdHJpbmcsIHN0cmluZywgc3RyaW5nLCBzdHJpbmcsIHN0cmluZyBdO1xuXG5jb25zdCBkZWZhdWx0Rm9ybWF0dHRlciA9IGZ1bmN0aW9uKHRoZW46IG51bWJlcik6IHt2YWx1ZTogbnVtYmVyLCB1bml0OiBVbml0LCBzdWZmaXg6IFN1ZmZpeH0ge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBjb25zdCBzZWNvbmRzID0gTWF0aC5yb3VuZChNYXRoLmFicyhub3cgLSB0aGVuKSAvIDEwMDApO1xuICBjb25zdCBzdWZmaXg6IFN1ZmZpeCA9IHRoZW4gPCBub3cgPyAnYWdvJyA6ICdmcm9tIG5vdyc7XG5cbiAgY29uc3QgW3ZhbHVlLCB1bml0XTogW251bWJlciwgVW5pdF0gPVxuICAgIHNlY29uZHMgPCBNSU5VVEVcbiAgICAgID8gW01hdGgucm91bmQoc2Vjb25kcyksICdzZWNvbmQnXVxuICAgICAgOiBzZWNvbmRzIDwgSE9VUlxuICAgICAgICA/IFtNYXRoLnJvdW5kKHNlY29uZHMgLyBNSU5VVEUpLCAnbWludXRlJ11cbiAgICAgICAgOiBzZWNvbmRzIDwgREFZXG4gICAgICAgICAgPyBbTWF0aC5yb3VuZChzZWNvbmRzIC8gSE9VUiksICdob3VyJ11cbiAgICAgICAgICA6IHNlY29uZHMgPCBXRUVLXG4gICAgICAgICAgICA/IFtNYXRoLnJvdW5kKHNlY29uZHMgLyBEQVkpLCAnZGF5J11cbiAgICAgICAgICAgIDogc2Vjb25kcyA8IE1PTlRIXG4gICAgICAgICAgICAgID8gW01hdGgucm91bmQoc2Vjb25kcyAvIFdFRUspLCAnd2VlayddXG4gICAgICAgICAgICAgIDogc2Vjb25kcyA8IFlFQVJcbiAgICAgICAgICAgICAgICA/IFtNYXRoLnJvdW5kKHNlY29uZHMgLyBNT05USCksICdtb250aCddXG4gICAgICAgICAgICAgICAgOiBbTWF0aC5yb3VuZChzZWNvbmRzIC8gWUVBUiksICd5ZWFyJ107XG5cbiAgcmV0dXJuIHt2YWx1ZSwgdW5pdCwgc3VmZml4fTtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRpbWVhZ29Gb3JtYXR0ZXIge1xuICBhYnN0cmFjdCBmb3JtYXQodGhlbjogbnVtYmVyKTogc3RyaW5nXG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBUaW1lYWdvRGVmYXVsdEZvcm1hdHRlciBleHRlbmRzIFRpbWVhZ29Gb3JtYXR0ZXIge1xuICBmb3JtYXQodGhlbjogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB7c3VmZml4LCB2YWx1ZSwgdW5pdH0gPSBkZWZhdWx0Rm9ybWF0dHRlcih0aGVuKTtcbiAgICByZXR1cm4gdGhpcy5wYXJzZSh2YWx1ZSwgdW5pdCwgc3VmZml4KTtcbiAgfVxuXG4gIHByaXZhdGUgcGFyc2UodmFsdWU6IG51bWJlciwgdW5pdDogVW5pdCwgc3VmZml4OiBTdWZmaXgpOiBzdHJpbmcge1xuICAgIGlmICh2YWx1ZSAhPT0gMSkge1xuICAgICAgdW5pdCArPSAncyc7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZSArICcgJyArIHVuaXQgKyAnICcgKyBzdWZmaXg7XG4gIH1cbn1cblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFRpbWVhZ29DdXN0b21Gb3JtYXR0ZXIgZXh0ZW5kcyBUaW1lYWdvRm9ybWF0dGVyIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBpbnRsOiBUaW1lYWdvSW50bCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBmb3JtYXQodGhlbjogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB7c3VmZml4LCB2YWx1ZSwgdW5pdH0gPSBkZWZhdWx0Rm9ybWF0dHRlcih0aGVuKTtcbiAgICByZXR1cm4gdGhpcy5wYXJzZSh2YWx1ZSwgdW5pdCwgc3VmZml4LCBEYXRlLm5vdygpLCB0aGVuKTtcbiAgfVxuXG4gIHByaXZhdGUgcGFyc2UodmFsdWU6IG51bWJlciwgdW5pdDogVW5pdCwgc3VmZml4OiBTdWZmaXgsIG5vdzogbnVtYmVyLCB0aGVuOiBudW1iZXIpIHtcbiAgICAvKiogY29udmVydCB3ZWVrcyB0byBkYXlzIGlmIHN0cmluZ3MgZG9uJ3QgaGFuZGxlIHdlZWtzICovXG4gICAgaWYgKHVuaXQgPT09ICd3ZWVrJyAmJiAhdGhpcy5pbnRsLnN0cmluZ3Mud2VlayAmJiAhdGhpcy5pbnRsLnN0cmluZ3Mud2Vla3MpIHtcbiAgICAgIGNvbnN0IGRheXMgPSBNYXRoLnJvdW5kKE1hdGguYWJzKG5vdyAtIHRoZW4pIC8gKDEwMDAgKiA2MCAqIDYwICogMjQpKTtcbiAgICAgIHZhbHVlID0gZGF5cztcbiAgICAgIHVuaXQgPSAnZGF5JztcbiAgICB9XG5cbiAgICAvKiogY3JlYXRlIGEgbm9ybWFsaXplIGZ1bmN0aW9uIGZvciBnaXZlbiB2YWx1ZSAqL1xuICAgIGNvbnN0IG5vcm1hbGl6ZSA9IHRoaXMubm9ybWFsaXplRm4odmFsdWUsIG5vdyAtIHRoZW4sIHRoaXMuaW50bC5zdHJpbmdzLm51bWJlcnMpO1xuXG4gICAgLyoqIFRoZSBldmVudHVhbCByZXR1cm4gdmFsdWUgc3RvcmVkIGluIGFuIGFycmF5IHNvIHRoYXQgdGhlIHdvcmRTZXBhcmF0b3IgY2FuIGJlIHVzZWQgKi9cbiAgICBjb25zdCBkYXRlU3RyaW5nOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLyoqIGhhbmRsZSBwcmVmaXhlcyAqL1xuICAgIGlmIChzdWZmaXggPT09ICdhZ28nICYmIHRoaXMuaW50bC5zdHJpbmdzLnByZWZpeEFnbykge1xuICAgICAgZGF0ZVN0cmluZy5wdXNoKG5vcm1hbGl6ZSh0aGlzLmludGwuc3RyaW5ncy5wcmVmaXhBZ28pKTtcbiAgICB9XG4gICAgaWYgKHN1ZmZpeCA9PT0gJ2Zyb20gbm93JyAmJiB0aGlzLmludGwuc3RyaW5ncy5wcmVmaXhGcm9tTm93KSB7XG4gICAgICBkYXRlU3RyaW5nLnB1c2gobm9ybWFsaXplKHRoaXMuaW50bC5zdHJpbmdzLnByZWZpeEZyb21Ob3cpKTtcbiAgICB9XG5cbiAgICAvKiogSGFuZGxlIE1haW4gbnVtYmVyIGFuZCB1bml0ICovXG4gICAgY29uc3QgaXNQbHVyYWwgPSB2YWx1ZSA+IDE7XG4gICAgaWYgKGlzUGx1cmFsKSB7XG4gICAgICBjb25zdCBzdHJpbmdGbjogU3RyaW5nT3JGbiA9IHRoaXMuaW50bC5zdHJpbmdzW3VuaXQgKyAncyddIHx8IHRoaXMuaW50bC5zdHJpbmdzW3VuaXRdIHx8ICclZCAnICsgdW5pdDtcbiAgICAgIGRhdGVTdHJpbmcucHVzaChub3JtYWxpemUoc3RyaW5nRm4pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc3RyaW5nRm46IFN0cmluZ09yRm4gPSB0aGlzLmludGwuc3RyaW5nc1t1bml0XSB8fCB0aGlzLmludGwuc3RyaW5nc1t1bml0ICsgJ3MnXSB8fCAnJWQgJyArIHVuaXQ7XG4gICAgICBkYXRlU3RyaW5nLnB1c2gobm9ybWFsaXplKHN0cmluZ0ZuKSk7XG4gICAgfVxuXG4gICAgLyoqIEhhbmRsZSBTdWZmaXhlcyAqL1xuICAgIGlmIChzdWZmaXggPT09ICdhZ28nICYmIHRoaXMuaW50bC5zdHJpbmdzLnN1ZmZpeEFnbykge1xuICAgICAgZGF0ZVN0cmluZy5wdXNoKG5vcm1hbGl6ZSh0aGlzLmludGwuc3RyaW5ncy5zdWZmaXhBZ28pKTtcbiAgICB9XG4gICAgaWYgKHN1ZmZpeCA9PT0gJ2Zyb20gbm93JyAmJiB0aGlzLmludGwuc3RyaW5ncy5zdWZmaXhGcm9tTm93KSB7XG4gICAgICBkYXRlU3RyaW5nLnB1c2gobm9ybWFsaXplKHRoaXMuaW50bC5zdHJpbmdzLnN1ZmZpeEZyb21Ob3cpKTtcbiAgICB9XG5cbiAgICAvKiogam9pbiB0aGUgYXJyYXkgaW50byBhIHN0cmluZyBhbmQgcmV0dXJuIGl0ICovXG4gICAgY29uc3Qgd29yZFNlcGFyYXRvciA9IHR5cGVvZiB0aGlzLmludGwuc3RyaW5ncy53b3JkU2VwYXJhdG9yID09PSAnc3RyaW5nJyA/IHRoaXMuaW50bC5zdHJpbmdzLndvcmRTZXBhcmF0b3IgOiAnICc7XG4gICAgcmV0dXJuIGRhdGVTdHJpbmcuam9pbih3b3JkU2VwYXJhdG9yKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJZiB0aGUgbnVtYmVycyBhcnJheSBpcyBwcmVzZW50LCBmb3JtYXQgbnVtYmVycyB3aXRoIGl0LFxuICAgKiBvdGhlcndpc2UganVzdCBjYXN0IHRoZSBudW1iZXIgdG8gYSBzdHJpbmcgYW5kIHJldHVybiBpdFxuICAqL1xuICBwcml2YXRlIG5vcm1hbGl6ZU51bWJlcihudW1iZXJzOiBOdW1iZXJBcnJheSwgdmFsdWU6IG51bWJlcikge1xuICAgIHJldHVybiBudW1iZXJzICYmIG51bWJlcnMubGVuZ3RoID09PSAxMFxuICAgICAgPyBTdHJpbmcodmFsdWUpLnNwbGl0KCcnKVxuICAgICAgICAgIC5tYXAoKGRpZ2l0OiBzdHJpbmcpID0+IGRpZ2l0Lm1hdGNoKC9eWzAtOV0kLykgPyBudW1iZXJzW3BhcnNlSW50KGRpZ2l0LCAxMCldIDogZGlnaXQpXG4gICAgICAgICAgLmpvaW4oJycpXG4gICAgICA6IFN0cmluZyh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogVGFrZSBhIHN0cmluZyBvciBhIGZ1bmN0aW9uIHRoYXQgdGFrZXMgbnVtYmVyIG9mIGRheXMgYW5kIHJldHVybnMgYSBzdHJpbmdcbiAgICogYW5kIHByb3ZpZGUgYSB1bmlmb3JtIEFQSSB0byBjcmVhdGUgc3RyaW5nIHBhcnRzXG4gICovXG4gIHByaXZhdGUgbm9ybWFsaXplRm4odmFsdWU6IG51bWJlciwgbWlsbGlzRGVsdGE6IG51bWJlciwgbnVtYmVycz86IE51bWJlckFycmF5KSB7XG4gICAgcmV0dXJuIChzdHJpbmdPckZuOiBTdHJpbmdPckZuKSA9PlxuICAgICAgdHlwZW9mIHN0cmluZ09yRm4gPT09ICdmdW5jdGlvbidcbiAgICAgID8gc3RyaW5nT3JGbih2YWx1ZSwgbWlsbGlzRGVsdGEpLnJlcGxhY2UoLyVkL2csIHRoaXMubm9ybWFsaXplTnVtYmVyKG51bWJlcnMsIHZhbHVlKSlcbiAgICAgIDogc3RyaW5nT3JGbi5yZXBsYWNlKC8lZC9nLCB0aGlzLm5vcm1hbGl6ZU51bWJlcihudW1iZXJzLCB2YWx1ZSkpO1xuICB9XG59XG4iLCJpbXBvcnQge1xuICBEaXJlY3RpdmUsXG4gIElucHV0LFxuICBFbGVtZW50UmVmLFxuICBPcHRpb25hbCxcbiAgU2ltcGxlQ2hhbmdlcyxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIENoYW5nZURldGVjdG9yUmVmXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBUaW1lYWdvQ2xvY2sgfSBmcm9tICcuL3RpbWVhZ28uY2xvY2snO1xuaW1wb3J0IHsgVGltZWFnb0Zvcm1hdHRlciB9IGZyb20gJy4vdGltZWFnby5mb3JtYXR0ZXInO1xuaW1wb3J0IHsgVGltZWFnb0ludGwgfSBmcm9tICcuL3RpbWVhZ28uaW50bCc7XG5pbXBvcnQgeyBpc0RlZmluZWQsIGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSwgZGF0ZVBhcnNlciB9IGZyb20gJy4vdXRpbCc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1t0aW1lYWdvXScsXG4gIGV4cG9ydEFzOiAndGltZWFnbycsXG59KVxuZXhwb3J0IGNsYXNzIFRpbWVhZ29EaXJlY3RpdmUgaW1wbGVtZW50cyBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XG4gIHByaXZhdGUgaW50bFN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBwcml2YXRlIGNsb2NrU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG5cbiAgLyoqXG4gICAqIEVtaXRzIG9uOlxuICAgKiAtIElucHV0IGNoYW5nZVxuICAgKiAtIEludGwgY2hhbmdlXG4gICAqIC0gQ2xvY2sgdGlja1xuICAqL1xuICBzdGF0ZUNoYW5nZXMgPSBuZXcgU3ViamVjdDxhbnk+KCk7XG5cbiAgLyoqIFRoZSBEYXRlIHRvIGRpc3BsYXkuIEFuIGFjdHVhbCBEYXRlIG9iamVjdCBvciBzb21ldGhpbmcgdGhhdCBjYW4gYmUgZmVkIHRvIG5ldyBEYXRlLiAqL1xuICBASW5wdXQoKVxuICBnZXQgZGF0ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9kYXRlO1xuICB9XG4gIHNldCBkYXRlKGRhdGU6IG51bWJlcikge1xuICAgIHRoaXMuX2RhdGUgPSBkYXRlUGFyc2VyKGRhdGUpLnZhbHVlT2YoKTtcbiAgICBpZiAodGhpcy5fZGF0ZSkge1xuICAgICAgaWYgKHRoaXMuY2xvY2tTdWJzY3JpcHRpb24pIHtcbiAgICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLmNsb2NrU3Vic2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbiA9IHRoaXMuY2xvY2sudGljayhkYXRlKVxuICAgICAgICAucGlwZShmaWx0ZXIoKCkgPT4gdGhpcy5saXZlLCB0aGlzKSlcbiAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoYFdyb25nIHBhcmFtZXRlciBpbiBUaW1lYWdvRGlyZWN0aXZlLiBFeHBlY3RlZCBhIHZhbGlkIGRhdGUsIHJlY2VpdmVkOiAke2RhdGV9YCk7XG4gICAgfVxuICB9XG4gIHByaXZhdGUgX2RhdGU6IG51bWJlcjtcblxuICAvKiogSWYgdGhlIGRpcmVjdGl2ZSBzaG91bGQgdXBkYXRlIGl0c2VsZiBvdmVyIHRpbWUgKi9cbiAgQElucHV0KClcbiAgZ2V0IGxpdmUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2xpdmU7XG4gIH1cbiAgc2V0IGxpdmUobGl2ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2xpdmUgPSBjb2VyY2VCb29sZWFuUHJvcGVydHkobGl2ZSk7XG4gIH1cbiAgcHJpdmF0ZSBfbGl2ZSA9IHRydWU7XG5cbiAgY29uc3RydWN0b3IoQE9wdGlvbmFsKCkgaW50bDogVGltZWFnb0ludGwsXG4gICAgICAgICAgICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICAgICAgICBmb3JtYXR0ZXI6IFRpbWVhZ29Gb3JtYXR0ZXIsXG4gICAgICAgICAgICAgIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgICAgICAgICAgIHByaXZhdGUgY2xvY2s6IFRpbWVhZ29DbG9jaykge1xuICAgIGlmIChpbnRsKSB7XG4gICAgICB0aGlzLmludGxTdWJzY3JpcHRpb24gPSBpbnRsLmNoYW5nZXMuc3Vic2NyaWJlKCgpID0+IHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKSk7XG4gICAgfVxuICAgIHRoaXMuc3RhdGVDaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICB0aGlzLnNldENvbnRlbnQoZWxlbWVudC5uYXRpdmVFbGVtZW50LCBmb3JtYXR0ZXIuZm9ybWF0KHRoaXMuZGF0ZSkpO1xuICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCk7XG4gIH1cblxuICBzZXRDb250ZW50KG5vZGU6IGFueSwgY29udGVudDogc3RyaW5nKSB7XG4gICAgaWYgKGlzRGVmaW5lZChub2RlLnRleHRDb250ZW50KSkge1xuICAgICAgbm9kZS50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGUuZGF0YSA9IGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgaWYgKHRoaXMuaW50bFN1YnNjcmlwdGlvbikge1xuICAgICAgdGhpcy5pbnRsU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICB0aGlzLmludGxTdWJzY3JpcHRpb24gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlmICh0aGlzLmNsb2NrU3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLmNsb2NrU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICB0aGlzLmNsb2NrU3Vic2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0aGlzLnN0YXRlQ2hhbmdlcy5jb21wbGV0ZSgpO1xuICB9XG59XG4iLCJpbXBvcnQge1xuICBJbmplY3RhYmxlLFxuICBPbkRlc3Ryb3ksXG4gIFBpcGUsXG4gIFBpcGVUcmFuc2Zvcm0sXG4gIE9wdGlvbmFsLFxuICBDaGFuZ2VEZXRlY3RvclJlZlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgVGltZWFnb0Nsb2NrIH0gZnJvbSAnLi90aW1lYWdvLmNsb2NrJztcbmltcG9ydCB7IFRpbWVhZ29Gb3JtYXR0ZXIgfSBmcm9tICcuL3RpbWVhZ28uZm9ybWF0dGVyJztcbmltcG9ydCB7IFRpbWVhZ29JbnRsIH0gZnJvbSAnLi90aW1lYWdvLmludGwnO1xuaW1wb3J0IHsgaXNEZWZpbmVkLCBjb2VyY2VCb29sZWFuUHJvcGVydHksIGRhdGVQYXJzZXIgfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5ASW5qZWN0YWJsZSgpXG5AUGlwZSh7XG4gIG5hbWU6ICd0aW1lYWdvJyxcbiAgcHVyZTogZmFsc2UsIC8vIHJlcXVpcmVkIHRvIHVwZGF0ZSB0aGUgdmFsdWUgd2hlbiBzdGF0ZUNoYW5nZXMgZW1pdHNcbn0pXG5leHBvcnQgY2xhc3MgVGltZWFnb1BpcGUgaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtLCBPbkRlc3Ryb3kge1xuICBwcml2YXRlIGludGxTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgcHJpdmF0ZSBjbG9ja1N1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIHByaXZhdGUgZGF0ZTogbnVtYmVyO1xuICBwcml2YXRlIHZhbHVlOiBzdHJpbmc7XG4gIHByaXZhdGUgbGl2ZSA9IHRydWU7XG5cbiAgLyoqXG4gICAqIEVtaXRzIG9uOlxuICAgKiAtIElucHV0IGNoYW5nZVxuICAgKiAtIEludGwgY2hhbmdlXG4gICAqIC0gQ2xvY2sgdGlja1xuICAqL1xuICBzdGF0ZUNoYW5nZXMgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gIGNvbnN0cnVjdG9yKEBPcHRpb25hbCgpIGludGw6IFRpbWVhZ29JbnRsLFxuICAgIGNkOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBwcml2YXRlIGZvcm1hdHRlcjogVGltZWFnb0Zvcm1hdHRlcixcbiAgICBwcml2YXRlIGNsb2NrOiBUaW1lYWdvQ2xvY2spIHtcbiAgICBpZiAoaW50bCkge1xuICAgICAgdGhpcy5pbnRsU3Vic2NyaXB0aW9uID0gaW50bC5jaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCkpO1xuICAgIH1cbiAgICB0aGlzLnN0YXRlQ2hhbmdlcy5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy52YWx1ZSA9IGZvcm1hdHRlci5mb3JtYXQodGhpcy5kYXRlKTtcbiAgICAgIGNkLm1hcmtGb3JDaGVjaygpO1xuICAgIH0pO1xuICB9XG5cbiAgdHJhbnNmb3JtKGRhdGU6IG51bWJlciwgLi4uYXJnczogYW55W10pIHtcbiAgICBjb25zdCBfZGF0ZSA9IGRhdGVQYXJzZXIoZGF0ZSkudmFsdWVPZigpO1xuICAgIGxldCBfbGl2ZTogYm9vbGVhbjtcblxuICAgIF9saXZlID0gaXNEZWZpbmVkKGFyZ3NbMF0pXG4gICAgICA/IGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eShhcmdzWzBdKVxuICAgICAgOiB0aGlzLmxpdmU7XG5cbiAgICBpZiAodGhpcy5kYXRlID09PSBfZGF0ZSAmJiB0aGlzLmxpdmUgPT09IF9saXZlKSB7XG4gICAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgICB9XG5cbiAgICB0aGlzLmRhdGUgPSBfZGF0ZTtcbiAgICB0aGlzLmxpdmUgPSBfbGl2ZTtcblxuICAgIGlmICh0aGlzLmRhdGUpIHtcbiAgICAgIGlmICh0aGlzLmNsb2NrU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuY2xvY2tTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2xvY2tTdWJzY3JpcHRpb24gPSB0aGlzLmNsb2NrLnRpY2soZGF0ZSlcbiAgICAgICAgLnBpcGUoZmlsdGVyKCgpID0+IHRoaXMubGl2ZSwgdGhpcykpXG4gICAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5zdGF0ZUNoYW5nZXMubmV4dCgpKTtcbiAgICAgIHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGBXcm9uZyBwYXJhbWV0ZXIgaW4gVGltZWFnb1BpcGUuIEV4cGVjdGVkIGEgdmFsaWQgZGF0ZSwgcmVjZWl2ZWQ6ICR7ZGF0ZX1gKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIGlmICh0aGlzLmludGxTdWJzY3JpcHRpb24pIHtcbiAgICAgIHRoaXMuaW50bFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgdGhpcy5pbnRsU3Vic2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodGhpcy5jbG9ja1N1YnNjcmlwdGlvbikge1xuICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbiA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdGhpcy5zdGF0ZUNoYW5nZXMuY29tcGxldGUoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTmdNb2R1bGUsIE1vZHVsZVdpdGhQcm92aWRlcnMsIFByb3ZpZGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBUaW1lYWdvRGlyZWN0aXZlIH0gZnJvbSAnLi90aW1lYWdvLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBUaW1lYWdvUGlwZSB9IGZyb20gJy4vdGltZWFnby5waXBlJztcbmltcG9ydCB7IFRpbWVhZ29JbnRsIH0gZnJvbSAnLi90aW1lYWdvLmludGwnO1xuaW1wb3J0IHsgVGltZWFnb0Nsb2NrLCBUaW1lYWdvRGVmYXVsdENsb2NrIH0gZnJvbSAnLi90aW1lYWdvLmNsb2NrJztcbmltcG9ydCB7IFRpbWVhZ29Gb3JtYXR0ZXIsIFRpbWVhZ29EZWZhdWx0Rm9ybWF0dGVyIH0gZnJvbSAnLi90aW1lYWdvLmZvcm1hdHRlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGltZWFnb01vZHVsZUNvbmZpZyB7XG4gIGNsb2NrPzogUHJvdmlkZXI7XG4gIGludGw/OiBQcm92aWRlcjtcbiAgZm9ybWF0dGVyPzogUHJvdmlkZXI7XG59XG5cbkBOZ01vZHVsZSh7XG4gIGRlY2xhcmF0aW9uczogW1xuICAgIFRpbWVhZ29EaXJlY3RpdmUsXG4gICAgVGltZWFnb1BpcGUsXG4gIF0sXG4gIGV4cG9ydHM6IFtcbiAgICBUaW1lYWdvRGlyZWN0aXZlLFxuICAgIFRpbWVhZ29QaXBlLFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBUaW1lYWdvTW9kdWxlIHtcbiAgLyoqXG4gICAqIFVzZSB0aGlzIG1ldGhvZCBpbiB5b3VyIHJvb3QgbW9kdWxlIHRvIHByb3ZpZGUgdGhlIFRpbWVhZ29Nb2R1bGVcbiAgICovXG4gIHN0YXRpYyBmb3JSb290KGNvbmZpZzogVGltZWFnb01vZHVsZUNvbmZpZyA9IHt9KTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBUaW1lYWdvTW9kdWxlLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIGNvbmZpZy5jbG9jayB8fCB7cHJvdmlkZTogVGltZWFnb0Nsb2NrLCB1c2VDbGFzczogVGltZWFnb0RlZmF1bHRDbG9ja30sXG4gICAgICAgIGNvbmZpZy5pbnRsIHx8IFtdLFxuICAgICAgICBjb25maWcuZm9ybWF0dGVyIHx8IHtwcm92aWRlOiBUaW1lYWdvRm9ybWF0dGVyLCB1c2VDbGFzczogVGltZWFnb0RlZmF1bHRGb3JtYXR0ZXJ9LFxuICAgICAgXSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZSB0aGlzIG1ldGhvZCBpbiB5b3VyIG90aGVyIChub24gcm9vdCkgbW9kdWxlcyB0byBpbXBvcnQgdGhlIGRpcmVjdGl2ZS9waXBlXG4gICAqL1xuICBzdGF0aWMgZm9yQ2hpbGQoY29uZmlnOiBUaW1lYWdvTW9kdWxlQ29uZmlnID0ge30pOiBNb2R1bGVXaXRoUHJvdmlkZXJzIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmdNb2R1bGU6IFRpbWVhZ29Nb2R1bGUsXG4gICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgY29uZmlnLmNsb2NrIHx8IHtwcm92aWRlOiBUaW1lYWdvQ2xvY2ssIHVzZUNsYXNzOiBUaW1lYWdvRGVmYXVsdENsb2NrfSxcbiAgICAgICAgY29uZmlnLmludGwgfHwgW10sXG4gICAgICAgIGNvbmZpZy5mb3JtYXR0ZXIgfHwge3Byb3ZpZGU6IFRpbWVhZ29Gb3JtYXR0ZXIsIHVzZUNsYXNzOiBUaW1lYWdvRGVmYXVsdEZvcm1hdHRlcn0sXG4gICAgICBdLFxuICAgIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJ0c2xpYl8xLl9fZXh0ZW5kcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBLG1CQUEwQixLQUFVO0lBQ2xDLE9BQU8sT0FBTyxLQUFLLEtBQUssV0FBVyxJQUFJLEtBQUssS0FBSyxJQUFJLENBQUM7Q0FDdkQ7Ozs7O0FBRUQsK0JBQXNDLEtBQVU7SUFDOUMsT0FBTyxLQUFLLElBQUksSUFBSSxJQUFJLEtBQUcsS0FBTyxLQUFL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